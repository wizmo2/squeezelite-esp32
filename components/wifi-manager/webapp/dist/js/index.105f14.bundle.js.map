{"version":3,"file":"./js/index.105f14.bundle.js","mappings":"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","sources":["webpack://squeezelite-esp32/webpack/runtime/chunk loaded","webpack://squeezelite-esp32/./src/js/custom.js","webpack://squeezelite-esp32/./src/index.ts","webpack://squeezelite-esp32/webpack/bootstrap","webpack://squeezelite-esp32/webpack/runtime/compat get default export","webpack://squeezelite-esp32/webpack/runtime/define property getters","webpack://squeezelite-esp32/webpack/runtime/global","webpack://squeezelite-esp32/webpack/runtime/hasOwnProperty shorthand","webpack://squeezelite-esp32/webpack/runtime/make namespace object","webpack://squeezelite-esp32/webpack/runtime/node module decorator","webpack://squeezelite-esp32/webpack/runtime/jsonp chunk loading","webpack://squeezelite-esp32/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var he = require('he');\r\nvar Promise = require('es6-promise').Promise;\r\nwindow.bootstrap = require('bootstrap');\r\nimport Cookies from 'js-cookie';\r\n\r\n\r\n\r\nif (!String.prototype.format) {\r\n  Object.assign(String.prototype, {\r\n    format() {\r\n      const args = arguments;\r\n      return this.replace(/{(\\d+)}/g, function (match, number) {\r\n        return typeof args[number] !== 'undefined' ? args[number] : match;\r\n      });\r\n    },\r\n  });\r\n}\r\nif (!String.prototype.encodeHTML) {\r\n  Object.assign(String.prototype, {\r\n    encodeHTML() {\r\n      return he.encode(this).replace(/\\n/g, '<br />');\r\n    },\r\n  });\r\n}\r\nObject.assign(Date.prototype, {\r\n  toLocalShort() {\r\n    const opt = { dateStyle: 'short', timeStyle: 'short' };\r\n    return this.toLocaleString(undefined, opt);\r\n  },\r\n});\r\nfunction get_control_option_value(obj) {\r\n  let ctrl,id,val,opt;\r\n  let radio = false;\r\n  let checked = false;\r\n  if (typeof (obj) === 'string') {\r\n    id = obj;\r\n    ctrl = $(`#${id}`);\r\n  } else {\r\n    id = $(obj).attr('id');\r\n    ctrl = $(obj);\r\n  }\r\n  if(ctrl.attr('type') === 'checkbox'){\r\n    opt = $(obj).checked?id.replace('cmd_opt_', ''):'';\r\n    val = true;\r\n  }\r\n  else {\r\n    opt = id.replace('cmd_opt_', '');\r\n    val = $(obj).val();\r\n    val = `${val.includes(\" \") ? '\"' : ''}${val}${val.includes(\" \") ? '\"' : ''}`;\r\n  }\r\n\r\n  return { opt, val };\r\n}\r\nfunction handleNVSVisible() {\r\n  let nvs_previous_checked = isEnabled(Cookies.get(\"show-nvs\"));\r\n  $('input#show-nvs')[0].checked = nvs_previous_checked;\r\n  if ($('input#show-nvs')[0].checked || recovery) {\r\n    $('*[href*=\"-nvs\"]').show();\r\n  } else {\r\n    $('*[href*=\"-nvs\"]').hide();\r\n  }\r\n}\r\nfunction concatenateOptions(options) {\r\n  let commandLine = ' ';\r\n  for (const [option, value] of Object.entries(options)) {\r\n    if (option !== 'n' && option !== 'o') {\r\n      commandLine += `-${option} `;\r\n      if (value !== true) {\r\n        commandLine += `${value} `;\r\n      }\r\n    }\r\n  }\r\n  return commandLine;\r\n}\r\n\r\nfunction isEnabled(val) {\r\n  return val != undefined && typeof val === 'string' && val.match(\"[Yy1]\");\r\n}\r\n\r\nconst nvsTypes = {\r\n  NVS_TYPE_U8: 0x01,\r\n  /*! < Type uint8_t */\r\n  NVS_TYPE_I8: 0x11,\r\n  /*! < Type int8_t */\r\n  NVS_TYPE_U16: 0x02,\r\n  /*! < Type uint16_t */\r\n  NVS_TYPE_I16: 0x12,\r\n  /*! < Type int16_t */\r\n  NVS_TYPE_U32: 0x04,\r\n  /*! < Type uint32_t */\r\n  NVS_TYPE_I32: 0x14,\r\n  /*! < Type int32_t */\r\n  NVS_TYPE_U64: 0x08,\r\n  /*! < Type uint64_t */\r\n  NVS_TYPE_I64: 0x18,\r\n  /*! < Type int64_t */\r\n  NVS_TYPE_STR: 0x21,\r\n  /*! < Type string */\r\n  NVS_TYPE_BLOB: 0x42,\r\n  /*! < Type blob */\r\n  NVS_TYPE_ANY: 0xff /*! < Must be last */,\r\n};\r\nconst btIcons = {\r\n  bt_playing: { 'label': '', 'icon': 'media_bluetooth_on' },\r\n  bt_disconnected: { 'label': '', 'icon': 'media_bluetooth_off' },\r\n  bt_neutral: { 'label': '', 'icon': 'bluetooth' },\r\n  bt_connecting: { 'label': '', 'icon': 'bluetooth_searching' },\r\n  bt_connected: { 'label': '', 'icon': 'bluetooth_connected' },\r\n  bt_disabled: { 'label': '', 'icon': 'bluetooth_disabled' },\r\n  play_arrow: { 'label': '', 'icon': 'play_circle_filled' },\r\n  pause: { 'label': '', 'icon': 'pause_circle' },\r\n  stop: { 'label': '', 'icon': 'stop_circle' },\r\n  '': { 'label': '', 'icon': '' }\r\n};\r\nconst batIcons = [\r\n  { icon: \"battery_0_bar\", label: '▪', ranges: [{ f: 5.8, t: 6.8 }, { f: 8.8, t: 10.2 }] },\r\n  { icon: \"battery_2_bar\", label: '▪▪', ranges: [{ f: 6.8, t: 7.4 }, { f: 10.2, t: 11.1 }] },\r\n  { icon: \"battery_3_bar\", label: '▪▪▪', ranges: [{ f: 7.4, t: 7.5 }, { f: 11.1, t: 11.25 }] },\r\n  { icon: \"battery_4_bar\", label: '▪▪▪▪', ranges: [{ f: 7.5, t: 7.8 }, { f: 11.25, t: 11.7 }] }\r\n];\r\nconst btStateIcons = [\r\n  { desc: 'Idle', sub: ['bt_neutral'] },\r\n  { desc: 'Discovering', sub: ['bt_connecting'] },\r\n  { desc: 'Discovered', sub: ['bt_connecting'] },\r\n  { desc: 'Unconnected', sub: ['bt_disconnected'] },\r\n  { desc: 'Connecting', sub: ['bt_connecting'] },\r\n  {\r\n    desc: 'Connected',\r\n    sub: ['bt_connected', 'play_arrow', 'bt_playing', 'pause', 'stop'],\r\n  },\r\n  { desc: 'Disconnecting', sub: ['bt_disconnected'] },\r\n];\r\n\r\nconst pillcolors = {\r\n  MESSAGING_INFO: 'badge-success',\r\n  MESSAGING_WARNING: 'badge-warning',\r\n  MESSAGING_ERROR: 'badge-danger',\r\n};\r\nconst connectReturnCode = {\r\n  OK: 0,\r\n  FAIL: 1,\r\n  DISC: 2,\r\n  LOST: 3,\r\n  RESTORE: 4,\r\n  ETH: 5\r\n}\r\nconst taskStates = {\r\n  0: 'eRunning',\r\n  /*! < A task is querying the state of itself, so must be running. */\r\n  1: 'eReady',\r\n  /*! < The task being queried is in a read or pending ready list. */\r\n  2: 'eBlocked',\r\n  /*! < The task being queried is in the Blocked state. */\r\n  3: 'eSuspended',\r\n  /*! < The task being queried is in the Suspended state, or is in the Blocked state with an infinite time out. */\r\n  4: 'eDeleted',\r\n};\r\nlet flashState = {\r\n  NONE: 0,\r\n  REBOOT_TO_RECOVERY: 2,\r\n  SET_FWURL: 5,\r\n  FLASHING: 6,\r\n  DONE: 7,\r\n  UPLOADING: 8,\r\n  ERROR: 9,\r\n  UPLOADCOMPLETE: 10,\r\n  _state: -1,\r\n  olderRecovery: false,\r\n  statusText: '',\r\n  flashURL: '',\r\n  flashFileName: '',\r\n  statusPercent: 0,\r\n  Completed: false,\r\n  recovery: false,\r\n  prevRecovery: false,\r\n  updateModal: new bootstrap.Modal(document.getElementById('otadiv'), {}),\r\n  reset: function () {\r\n\r\n    this.olderRecovery = false;\r\n    this.statusText = '';\r\n    this.statusPercent = -1;\r\n    this.flashURL = '';\r\n    this.flashFileName = undefined;\r\n    this.UpdateProgress();\r\n    $('#rTable tr.release').removeClass('table-success table-warning');\r\n    $('.flact').prop('disabled', false);\r\n    $('#flashfilename').value = null;\r\n    $('#fw-url-input').value = null;\r\n    if (!this.isStateError()) {\r\n      $('span#flash-status').html('');\r\n      $('#fwProgressLabel').parent().removeClass('bg-danger');\r\n    }\r\n    this._state = this.NONE\r\n    return this;\r\n  },\r\n  isStateUploadComplete: function () {\r\n    return this._state == this.UPLOADCOMPLETE;\r\n  },\r\n  isStateError: function () {\r\n    return this._state == this.ERROR;\r\n  },\r\n  isStateNone: function () {\r\n    return this._state == this.NONE;\r\n  },\r\n  isStateRebootRecovery: function () {\r\n    return this._state == this.REBOOT_TO_RECOVERY;\r\n  },\r\n  isStateSetUrl: function () {\r\n    return this._state == this.SET_FWURL;\r\n  },\r\n  isStateFlashing: function () {\r\n    return this._state == this.FLASHING;\r\n  },\r\n  isStateDone: function () {\r\n    return this._state == this.DONE;\r\n  },\r\n  isStateUploading: function () {\r\n    return this._state == this.UPLOADING;\r\n  },\r\n  init: function () {\r\n    this._state = this.NONE;\r\n    return this;\r\n  },\r\n\r\n  SetStateError: function () {\r\n    this._state = this.ERROR;\r\n    $('#fwProgressLabel').parent().addClass('bg-danger');\r\n    return this;\r\n  },\r\n  SetStateNone: function () {\r\n    this._state = this.NONE;\r\n    return this;\r\n  },\r\n  SetStateRebootRecovery: function () {\r\n    this._state = this.REBOOT_TO_RECOVERY;\r\n    // Reboot system to recovery mode\r\n    this.SetStatusText('Starting recovery mode.')\r\n    $.ajax({\r\n      url: '/recovery.json',\r\n      context: this,\r\n      dataType: 'text',\r\n      method: 'POST',\r\n      cache: false,\r\n      contentType: 'application/json; charset=utf-8',\r\n      data: JSON.stringify({\r\n        timestamp: Date.now(),\r\n      }),\r\n      error: function (xhr, _ajaxOptions, thrownError) {\r\n        this.setOTAError(`Unexpected error while trying to restart to recovery. (status=${xhr.status ?? ''}, error=${thrownError ?? ''} ) `);\r\n      },\r\n      complete: function (response) {\r\n        this.SetStatusText('Waiting for system to boot.')\r\n      },\r\n    });\r\n    return this;\r\n  },\r\n  SetStateSetUrl: function () {\r\n    this._state = this.SET_FWURL;\r\n    this.statusText = 'Sending firmware download location.';\r\n    let confData = {\r\n      fwurl: {\r\n        value: this.flashURL,\r\n        type: 33,\r\n      }\r\n    };\r\n    post_config(confData);\r\n    return this;\r\n  },\r\n  SetStateFlashing: function () {\r\n    this._state = this.FLASHING;\r\n    return this;\r\n  },\r\n  SetStateDone: function () {\r\n    this._state = this.DONE;\r\n    this.reset();\r\n    return this;\r\n  },\r\n  SetStateUploading: function () {\r\n    this._state = this.UPLOADING;\r\n    return this.SetStatusText('Sending file to device.');\r\n  },\r\n  SetStateUploadComplete: function () {\r\n    this._state = this.UPLOADCOMPLETE;\r\n    return this;\r\n  },\r\n\r\n  isFlashExecuting: function () {\r\n    return true === (this._state != this.UPLOADING && (this.statusText !== '' || this.statusPercent >= 0));\r\n  },\r\n\r\n\r\n\r\n  toString: function () {\r\n    let keys = Object.keys(this);\r\n    return keys.find(x => this[x] === this._state);\r\n  },\r\n\r\n  setOTATargets: function () {\r\n    this.flashURL = '';\r\n    this.flashFileName = '';\r\n    this.flashURL = $('#fw-url-input').val();\r\n    let fileInput = $('#flashfilename')[0].files;\r\n    if (fileInput.length > 0) {\r\n      this.flashFileName = fileInput[0];\r\n    }\r\n    if (this.flashFileName.length == 0 && this.flashURL.length == 0) {\r\n      this.setOTAError('Invalid url or file. Cannot start OTA');\r\n    }\r\n    return this;\r\n  },\r\n\r\n  setOTAError: function (message) {\r\n    this.SetStateError().SetStatusPercent(0).SetStatusText(message).reset();\r\n    return this;\r\n  },\r\n\r\n  ShowDialog: function () {\r\n    if (!this.isStateNone()) {\r\n      this.updateModal.show();\r\n      $('.flact').prop('disabled', true);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  SetStatusPercent: function (pct) {\r\n    var pctChanged = (this.statusPercent != pct);\r\n    this.statusPercent = pct;\r\n    if (pctChanged) {\r\n      if (!this.isStateUploading() && !this.isStateFlashing()) {\r\n        this.SetStateFlashing();\r\n      }\r\n      if (pct == 100) {\r\n        if (this.isStateFlashing()) {\r\n          this.SetStateDone();\r\n        }\r\n        else if (this.isStateUploading()) {\r\n          this.statusPercent = 0;\r\n          this.SetStateFlashing();\r\n        }\r\n      }\r\n      this.UpdateProgress().ShowDialog();\r\n    }\r\n    return this;\r\n  },\r\n  SetStatusText: function (txt) {\r\n    var changed = (this.statusText != txt);\r\n    this.statusText = txt;\r\n    if (changed) {\r\n      $('span#flash-status').html(this.statusText);\r\n      this.ShowDialog();\r\n    }\r\n\r\n    return this;\r\n  },\r\n  UpdateProgress: function () {\r\n    $('.progress-bar')\r\n      .css('width', this.statusPercent + '%')\r\n      .attr('aria-valuenow', this.statusPercent)\r\n      .text(this.statusPercent + '%')\r\n    $('.progress-bar').html((this.isStateDone() ? 100 : this.statusPercent) + '%');\r\n    return this;\r\n  },\r\n  StartOTA: function () {\r\n    this.logEvent(this.StartOTA.name);\r\n    $('#fwProgressLabel').parent().removeClass('bg-danger');\r\n    this.setOTATargets();\r\n    if (this.isStateError()) {\r\n      return this;\r\n    }\r\n    if (!recovery) {\r\n      this.SetStateRebootRecovery();\r\n    }\r\n    else {\r\n      this.SetStateFlashing().TargetReadyStartOTA();\r\n    }\r\n\r\n    return this;\r\n  },\r\n  UploadLocalFile: function () {\r\n    this.SetStateUploading();\r\n    const xhttp = new XMLHttpRequest();\r\n    xhttp.context = this;\r\n    var boundHandleUploadProgressEvent = this.HandleUploadProgressEvent.bind(this);\r\n    var boundsetOTAError = this.setOTAError.bind(this);\r\n    xhttp.upload.addEventListener(\"progress\", boundHandleUploadProgressEvent, false);\r\n    xhttp.onreadystatechange = function () {\r\n      if (xhttp.readyState === 4) {\r\n        if (xhttp.status === 0 || xhttp.status === 404) {\r\n          boundsetOTAError(`Upload Failed. Recovery version might not support uploading. Please use web update instead.`);\r\n        }\r\n      }\r\n    };\r\n    xhttp.open('POST', '/flash.json', true);\r\n    xhttp.send(this.flashFileName);\r\n  },\r\n  TargetReadyStartOTA: function () {\r\n    if (recovery && this.prevRecovery && !this.isStateRebootRecovery() && !this.isStateFlashing()) {\r\n      // this should only execute once, while being in a valid state\r\n      return this;\r\n    }\r\n\r\n    this.logEvent(this.TargetReadyStartOTA.name);\r\n    if (!recovery) {\r\n      console.error('Event TargetReadyStartOTA fired in the wrong mode ');\r\n      return this;\r\n    }\r\n    this.prevRecovery = true;\r\n\r\n    if (this.flashFileName !== '') {\r\n      this.UploadLocalFile();\r\n    }\r\n    else if (this.flashURL != '') {\r\n      this.SetStateSetUrl();\r\n    }\r\n    else {\r\n      this.setOTAError('Invalid URL or file name while trying to start the OTa process')\r\n    }\r\n  },\r\n  HandleUploadProgressEvent: function (data) {\r\n    this.logEvent(this.HandleUploadProgressEvent.name);\r\n    this.SetStateUploading().SetStatusPercent(Math.round(data.loaded / data.total * 100)).SetStatusText('Uploading file to device');\r\n  },\r\n  EventTargetStatus: function (data) {\r\n    if (!this.isStateNone()) {\r\n      this.logEvent(this.EventTargetStatus.name);\r\n    }\r\n    if (data.ota_pct ?? -1 >= 0) {\r\n      this.olderRecovery = true;\r\n      this.SetStatusPercent(data.ota_pct);\r\n    }\r\n    if ((data.ota_dsc ?? '') != '') {\r\n      this.olderRecovery = true;\r\n      this.SetStatusText(data.ota_dsc);\r\n    }\r\n\r\n    if (data.recovery != undefined) {\r\n      this.recovery = data.recovery === 1 ? true : false;\r\n    }\r\n    if (this.isStateRebootRecovery() && this.recovery) {\r\n      this.TargetReadyStartOTA();\r\n    }\r\n  },\r\n  EventOTAMessageClass: function (data) {\r\n    this.logEvent(this.EventOTAMessageClass.name);\r\n    var otaData = JSON.parse(data);\r\n    this.SetStatusPercent(otaData.ota_pct).SetStatusText(otaData.ota_dsc);\r\n  },\r\n  logEvent: function (fun) {\r\n    console.log(`${fun}, flash state ${this.toString()}, recovery: ${this.recovery}, ota pct: ${this.statusPercent}, ota desc: ${this.statusText}`);\r\n  }\r\n\r\n};\r\nwindow.hideSurrounding = function (obj) {\r\n  $(obj).parent().parent().hide();\r\n}\r\n\r\nlet presetsloaded = false;\r\nlet is_i2c_locked = false;\r\nlet statusInterval = 2000;\r\nlet messageInterval = 2500;\r\nfunction post_config(data) {\r\n  let confPayload = {\r\n    timestamp: Date.now(),\r\n    config: data\r\n  };\r\n  $.ajax({\r\n    url: '/config.json',\r\n    dataType: 'text',\r\n    method: 'POST',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify(confPayload),\r\n    error: handleExceptionResponse,\r\n  });\r\n}\r\n\r\n\r\nwindow.hFlash = function () {\r\n  // reset file upload selection if any;\r\n  $('#flashfilename').value = null\r\n  flashState.StartOTA();\r\n}\r\nwindow.handleReboot = function (link) {\r\n  if (link == 'reboot_ota') {\r\n    $('#reboot_ota_nav').removeClass('active').prop(\"disabled\", true); delayReboot(500, '', 'reboot_ota');\r\n  }\r\n  else {\r\n    $('#reboot_nav').removeClass('active'); delayReboot(500, '', link);\r\n  }\r\n}\r\n\r\nfunction parseSqueezeliteCommandLine(commandLine) {\r\n  const options = {};\r\n  let output, name;\r\n  let otherValues = '';\r\n\r\n  const argRegex = /(\"[^\"]+\"|'[^']+'|\\S+)/g;\r\n  const args = commandLine.match(argRegex);\r\n\r\n  let i = 0;\r\n\r\n  while (i < args.length) {\r\n    const arg = args[i];\r\n\r\n    if (arg.startsWith('-')) {\r\n      const option = arg.slice(1);\r\n\r\n      if (option === '') {\r\n        otherValues += args.slice(i).join(' ');\r\n        break;\r\n      }\r\n\r\n      let value = true;\r\n\r\n      if (i + 1 < args.length && !args[i + 1].startsWith('-')) {\r\n        value = args[i + 1].replace(/\"/g, '').replace(/'/g, '');\r\n        i++;\r\n      }\r\n\r\n      options[option] = value;\r\n    } else {\r\n      otherValues += arg + ' ';\r\n    }\r\n\r\n    i++;\r\n  }\r\n\r\n  otherValues = otherValues.trim();\r\n  output = getOutput(options);\r\n  name = getName(options);\r\n  let otherOptions={btname:null,n:null};\r\n  // assign o and n options to otheroptions if present\r\n  if (options.o && output.toUpperCase() === 'BT') {\r\n    let temp = parseSqueezeliteCommandLine(options.o);\r\n    if(temp.name) {\r\n      otherOptions.btname = temp.name;\r\n    }\r\n    delete options.o;\r\n  }\r\n  if (options.n) {\r\n    otherOptions['n'] = options.n;\r\n    delete options.n;\r\n  }\r\n  return { name, output, options, otherValues,otherOptions };  \r\n}\r\n\r\nfunction getOutput(options) {\r\n  let output;\r\n  if (options.o){\r\n    output = options.o.replace(/\"/g, '').replace(/'/g, '');\r\n    /* set output as the first alphanumerical word in the command line */\r\n    if (output.indexOf(' ') > 0) {\r\n      output = output.substring(0, output.indexOf(' '));\r\n    }\r\n  }\r\n  return output;\r\n}\r\n\r\nfunction getName(options) {\r\n  let name;\r\n  /* if n option present, assign to name variable */\r\n  if (options.n){\r\n    name = options.n.replace(/\"/g, '').replace(/'/g, '');\r\n  }\r\n  return name;\r\n}\r\n\r\n\r\nfunction isConnected() {\r\n  return ConnectedTo.hasOwnProperty('ip') && ConnectedTo.ip != '0.0.0.0' && ConnectedTo.ip != '';\r\n}\r\nfunction getIcon(icons) {\r\n  return isConnected() ? icons.icon : icons.label;\r\n}\r\nfunction handlebtstate(data) {\r\n  let icon = '';\r\n  let tt = '';\r\n  if (data.bt_status !== undefined && data.bt_sub_status !== undefined) {\r\n    const iconindex = btStateIcons[data.bt_status].sub[data.bt_sub_status];\r\n    if (iconindex) {\r\n      icon = btIcons[iconindex];\r\n      tt = btStateIcons[data.bt_status].desc;\r\n    } else {\r\n      icon = btIcons.bt_connected;\r\n      tt = 'Output status';\r\n    }\r\n  }\r\n\r\n  $('#o_type').attr('title', tt);\r\n  $('#o_bt').html(isConnected() ? icon.label : icon.text);\r\n}\r\nfunction handleTemplateTypeRadio(outtype) {\r\n  $('#o_type').children('span').css({ display: 'none' });\r\n  let changed = false;\r\n  if (outtype === 'bt') {\r\n    changed = output !== 'bt' && output !== '';\r\n    output = 'bt';\r\n  } else if (outtype === 'spdif') {\r\n    changed = output !== 'spdif' && output !== '';\r\n    output = 'spdif';\r\n  } else {\r\n    changed = output !== 'i2s' && output !== '';\r\n    output = 'i2s';\r\n  }\r\n  $('#' + output).prop('checked', true);\r\n  $('#o_' + output).css({ display: 'inline' });\r\n  if (changed) {\r\n    Object.keys(commandDefaults[output]).forEach(function (key) {\r\n      $(`#cmd_opt_${key}`).val(commandDefaults[output][key]);\r\n    });\r\n  }\r\n}\r\n\r\nfunction handleExceptionResponse(xhr, _ajaxOptions, thrownError) {\r\n  console.log(xhr.status);\r\n  console.log(thrownError);\r\n  if (thrownError !== '') {\r\n    showLocalMessage(thrownError, 'MESSAGING_ERROR');\r\n  }\r\n}\r\nfunction HideCmdMessage(cmdname) {\r\n  $('#toast_' + cmdname)\r\n    .removeClass('table-success')\r\n    .removeClass('table-warning')\r\n    .removeClass('table-danger')\r\n    .addClass('table-success')\r\n    .removeClass('show');\r\n  $('#msg_' + cmdname).html('');\r\n}\r\nfunction showCmdMessage(cmdname, msgtype, msgtext, append = false) {\r\n  let color = 'table-success';\r\n  if (msgtype === 'MESSAGING_WARNING') {\r\n    color = 'table-warning';\r\n  } else if (msgtype === 'MESSAGING_ERROR') {\r\n    color = 'table-danger';\r\n  }\r\n  $('#toast_' + cmdname)\r\n    .removeClass('table-success')\r\n    .removeClass('table-warning')\r\n    .removeClass('table-danger')\r\n    .addClass(color)\r\n    .addClass('show');\r\n  let escapedtext = msgtext\r\n    .substring(0, msgtext.length - 1)\r\n    .encodeHTML()\r\n    .replace(/\\n/g, '<br />');\r\n  escapedtext =\r\n    ($('#msg_' + cmdname).html().length > 0 && append\r\n      ? $('#msg_' + cmdname).html() + '<br/>'\r\n      : '') + escapedtext;\r\n  $('#msg_' + cmdname).html(escapedtext);\r\n}\r\n\r\nlet releaseURL =\r\n  'https://api.github.com/repos/sle118/squeezelite-esp32/releases';\r\n\r\nlet recovery = false;\r\nlet messagesHeld = false;\r\nlet commandBTSinkName = '';\r\nconst commandHeader = 'squeezelite ';\r\nconst commandDefaults = {\r\n  i2s: { b: \"500:2000\", C: \"30\", W: \"\", Z: \"96000\", o: \"I2S\" },\r\n  spdif: { b: \"500:2000\", C: \"30\", W: \"\", Z: \"48000\", o: \"SPDIF\" },\r\n  bt: { b: \"500:2000\", C: \"30\", W: \"\", Z: \"44100\", o: \"BT\" },\r\n};\r\nlet validOptions = {\r\n  codecs: ['flac', 'pcm', 'mp3', 'ogg', 'aac', 'wma', 'alac', 'dsd', 'mad', 'mpg']\r\n};\r\n\r\n//let blockFlashButton = false;\r\nlet apList = null;\r\n//let selectedSSID = '';\r\n//let checkStatusInterval = null;\r\nlet messagecount = 0;\r\nlet messageseverity = 'MESSAGING_INFO';\r\nlet SystemConfig = {};\r\nlet LastCommandsState = null;\r\nvar output = '';\r\nlet hostName = '';\r\nlet versionName = 'Squeezelite-ESP32';\r\nlet prevmessage = '';\r\nlet project_name = versionName;\r\nlet depth = 16;\r\nlet board_model = '';\r\nlet platform_name = versionName;\r\nlet preset_name = '';\r\nlet btSinkNamesOptSel = '#cfg-audio-bt_source-sink_name';\r\nlet ConnectedTo = {};\r\nlet ConnectingToSSID = {};\r\nlet lmsBaseUrl;\r\nlet prevLMSIP = '';\r\nconst ConnectingToActions = {\r\n  'CONN': 0, 'MAN': 1, 'STS': 2,\r\n}\r\n\r\nPromise.prototype.delay = function (duration) {\r\n  return this.then(\r\n    function (value) {\r\n      return new Promise(function (resolve) {\r\n        setTimeout(function () {\r\n          resolve(value);\r\n        }, duration);\r\n      });\r\n    },\r\n    function (reason) {\r\n      return new Promise(function (_resolve, reject) {\r\n        setTimeout(function () {\r\n          reject(reason);\r\n        }, duration);\r\n      });\r\n    }\r\n  );\r\n};\r\n\r\nfunction getConfigJson(slimMode) {\r\n  const config = {};\r\n  $('input.nvs').each(function (_index, entry) {\r\n    if (!slimMode) {\r\n      const nvsType = parseInt(entry.attributes.nvs_type.value, 10);\r\n      if (entry.id !== '') {\r\n        config[entry.id] = {};\r\n        if (\r\n          nvsType === nvsTypes.NVS_TYPE_U8 ||\r\n          nvsType === nvsTypes.NVS_TYPE_I8 ||\r\n          nvsType === nvsTypes.NVS_TYPE_U16 ||\r\n          nvsType === nvsTypes.NVS_TYPE_I16 ||\r\n          nvsType === nvsTypes.NVS_TYPE_U32 ||\r\n          nvsType === nvsTypes.NVS_TYPE_I32 ||\r\n          nvsType === nvsTypes.NVS_TYPE_U64 ||\r\n          nvsType === nvsTypes.NVS_TYPE_I64\r\n        ) {\r\n          config[entry.id].value = parseInt(entry.value);\r\n        } else {\r\n          config[entry.id].value = entry.value;\r\n        }\r\n        config[entry.id].type = nvsType;\r\n      }\r\n    } else {\r\n      config[entry.id] = entry.value;\r\n    }\r\n  });\r\n  const key = $('#nvs-new-key').val();\r\n  const val = $('#nvs-new-value').val();\r\n  if (key !== '') {\r\n    if (!slimMode) {\r\n      config[key] = {};\r\n      config[key].value = val;\r\n      config[key].type = 33;\r\n    } else {\r\n      config[key] = val;\r\n    }\r\n  }\r\n  return config;\r\n}\r\n\r\nfunction handleHWPreset(allfields, reboot) {\r\n\r\n  const selJson = JSON.parse(allfields[0].value);\r\n  var cmd = allfields[0].attributes.cmdname.value;\r\n\r\n  console.log(`selected model: ${selJson.name}`);\r\n  let confPayload = {\r\n    timestamp: Date.now(),\r\n    config: { model_config: { value: selJson.name, type: 33 } }\r\n  };\r\n  for (const [name, value] of Object.entries(selJson.config)) {\r\n    const storedval = (typeof value === 'string' || value instanceof String) ? value : JSON.stringify(value);\r\n    confPayload.config[name] = {\r\n      value: storedval,\r\n      type: 33,\r\n    }\r\n    showCmdMessage(\r\n      cmd,\r\n      'MESSAGING_INFO',\r\n      `Setting ${name}=${storedval} `,\r\n      true\r\n    );\r\n  }\r\n\r\n  showCmdMessage(\r\n    cmd,\r\n    'MESSAGING_INFO',\r\n    `Committing `,\r\n    true\r\n  );\r\n  $.ajax({\r\n    url: '/config.json',\r\n    dataType: 'text',\r\n    method: 'POST',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify(confPayload),\r\n    error: function (xhr, _ajaxOptions, thrownError) {\r\n      handleExceptionResponse(xhr, _ajaxOptions, thrownError);\r\n      showCmdMessage(\r\n        cmd,\r\n        'MESSAGING_ERROR',\r\n        `Unexpected error ${(thrownError !== '') ? thrownError : 'with return status = ' + xhr.status} `,\r\n        true\r\n      );\r\n    },\r\n    success: function (response) {\r\n      showCmdMessage(\r\n        cmd,\r\n        'MESSAGING_INFO',\r\n        `Saving complete `,\r\n        true\r\n      );\r\n      console.log(response);\r\n      if (reboot) {\r\n        delayReboot(2500, cmd);\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\n\r\n// pull json file from https://gist.githubusercontent.com/sle118/dae585e157b733a639c12dc70f0910c5/raw/b462691f69e2ad31ac95c547af6ec97afb0f53db/squeezelite-esp32-presets.json and\r\nfunction loadPresets() {\r\n  if ($(\"#cfg-hw-preset-model_config\").length == 0) return;\r\n  if (presetsloaded) return;\r\n  presetsloaded = true;\r\n  $('#cfg-hw-preset-model_config').html('<option>--</option>');\r\n  $.getJSON(\r\n    'https://gist.githubusercontent.com/sle118/dae585e157b733a639c12dc70f0910c5/raw/',\r\n    { _: new Date().getTime() },\r\n    function (data) {\r\n      $.each(data, function (key, val) {\r\n        $('#cfg-hw-preset-model_config').append(`<option value='${JSON.stringify(val).replace(/\"/g, '\\\"').replace(/\\'/g, '\\\"')}'>${val.name}</option>`);\r\n        if (preset_name !== '' && preset_name == val.name) {\r\n          $('#cfg-hw-preset-model_config').val(preset_name);\r\n        }\r\n      });\r\n      if (preset_name !== '') {\r\n        ('#prev_preset').show().val(preset_name);\r\n      }\r\n    }\r\n\r\n  ).fail(function (jqxhr, textStatus, error) {\r\n    const err = textStatus + ', ' + error;\r\n    console.log('Request Failed: ' + err);\r\n  }\r\n  );\r\n}\r\n\r\nfunction delayReboot(duration, cmdname, ota = 'reboot') {\r\n  const url = '/' + ota + '.json';\r\n  $('tbody#tasks').empty();\r\n  $('#tasks_sect').css('visibility', 'collapse');\r\n  Promise.resolve({ cmdname: cmdname, url: url })\r\n    .delay(duration)\r\n    .then(function (data) {\r\n      if (data.cmdname.length > 0) {\r\n        showCmdMessage(\r\n          data.cmdname,\r\n          'MESSAGING_WARNING',\r\n          'System is rebooting.\\n',\r\n          true\r\n        );\r\n      } else {\r\n        showLocalMessage('System is rebooting.\\n', 'MESSAGING_WARNING');\r\n      }\r\n      console.log('now triggering reboot');\r\n      $(\"button[onclick*='handleReboot']\").addClass('rebooting');\r\n      $.ajax({\r\n        url: data.url,\r\n        dataType: 'text',\r\n        method: 'POST',\r\n        cache: false,\r\n        contentType: 'application/json; charset=utf-8',\r\n        data: JSON.stringify({\r\n          timestamp: Date.now(),\r\n        }),\r\n        error: handleExceptionResponse,\r\n        complete: function () {\r\n          console.log('reboot call completed');\r\n          Promise.resolve(data)\r\n            .delay(6000)\r\n            .then(function (rdata) {\r\n              if (rdata.cmdname.length > 0) {\r\n                HideCmdMessage(rdata.cmdname);\r\n              }\r\n              getCommands();\r\n              getConfig();\r\n            });\r\n        },\r\n      });\r\n    });\r\n}\r\n// eslint-disable-next-line no-unused-vars\r\nwindow.saveAutoexec1 = function (apply) {\r\n  showCmdMessage('cfg-audio-tmpl', 'MESSAGING_INFO', 'Saving.\\n', false);\r\n  let commandLine = `${commandHeader} -o ${output} `;\r\n  $('.sqcmd').each(function () {\r\n    let { opt, val } = get_control_option_value($(this));\r\n    if ((opt && opt.length>0 ) && typeof(val) == 'boolean' || val.length > 0) {\r\n      const optStr=opt===':'?opt:(` -${opt} `);\r\n      val = typeof(val) == 'boolean'?'':val;\r\n      commandLine += `${optStr} ${val}`;\r\n    }\r\n  });\r\n  const resample=$('#cmd_opt_R input[name=resample]:checked');\r\n  if (resample.length>0 && resample.attr('suffix')!=='') {\r\n    commandLine += resample.attr('suffix');\r\n    // now check resample_i option and if checked, add suffix to command line\r\n    if ($('#resample_i').is(\":checked\") && resample.attr('aint') =='true')  {\r\n          commandLine += $('#resample_i').attr('suffix');\r\n    }\r\n}\r\n\r\n    \r\n  if (output === 'bt') {\r\n    showCmdMessage(\r\n      'cfg-audio-tmpl',\r\n      'MESSAGING_INFO',\r\n      'Remember to configure the Bluetooth audio device name.\\n',\r\n      true\r\n    );\r\n  }\r\n  commandLine += concatenateOptions(options);\r\n  const data = {\r\n    timestamp: Date.now(),\r\n  };\r\n  data.config = {\r\n    autoexec1: { value: commandLine, type: 33 },\r\n    autoexec: {\r\n      value: $('#disable-squeezelite').prop('checked') ? '0' : '1',\r\n      type: 33,\r\n    },\r\n  };\r\n\r\n  $.ajax({\r\n    url: '/config.json',\r\n    dataType: 'text',\r\n    method: 'POST',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify(data),\r\n    error: handleExceptionResponse,\r\n    complete: function (response) {\r\n      if (\r\n        response.responseText &&\r\n        JSON.parse(response.responseText).result === 'OK'\r\n      ) {\r\n        showCmdMessage('cfg-audio-tmpl', 'MESSAGING_INFO', 'Done.\\n', true);\r\n        if (apply) {\r\n          delayReboot(1500, 'cfg-audio-tmpl');\r\n        }\r\n      } else if (JSON.parse(response.responseText).result) {\r\n        showCmdMessage(\r\n          'cfg-audio-tmpl',\r\n          'MESSAGING_WARNING',\r\n          JSON.parse(response.responseText).Result + '\\n',\r\n          true\r\n        );\r\n      } else {\r\n        showCmdMessage(\r\n          'cfg-audio-tmpl',\r\n          'MESSAGING_ERROR',\r\n          response.statusText + '\\n'\r\n        );\r\n      }\r\n      console.log(response.responseText);\r\n    },\r\n  });\r\n  console.log('sent data:', JSON.stringify(data));\r\n}\r\nwindow.handleDisconnect = function () {\r\n  $.ajax({\r\n    url: '/connect.json',\r\n    dataType: 'text',\r\n    method: 'DELETE',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify({\r\n      timestamp: Date.now(),\r\n    }),\r\n  });\r\n}\r\nfunction setPlatformFilter(val) {\r\n  if ($('.upf').filter(function () { return $(this).text().toUpperCase() === val.toUpperCase() }).length > 0) {\r\n    $('#splf').val(val).trigger('input');\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\nwindow.handleConnect = function () {\r\n  ConnectingToSSID.ssid = $('#manual_ssid').val();\r\n  ConnectingToSSID.pwd = $('#manual_pwd').val();\r\n  ConnectingToSSID.dhcpname = $('#dhcp-name2').val();\r\n  $(\"*[class*='connecting']\").hide();\r\n  $('#ssid-wait').text(ConnectingToSSID.ssid);\r\n  $('.connecting').show();\r\n  $.ajax({\r\n    url: '/connect.json',\r\n    dataType: 'text',\r\n    method: 'POST',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify({\r\n      timestamp: Date.now(),\r\n      ssid: ConnectingToSSID.ssid,\r\n      pwd: ConnectingToSSID.pwd\r\n    }),\r\n    error: handleExceptionResponse,\r\n  });\r\n\r\n  // now we can re-set the intervals regardless of result\r\n\r\n}\r\nfunction renderError(opt,error){\r\n  const fieldname = `cmd_opt_${opt}`;\r\n  let errorFieldName=`${fieldname}-error`;\r\n  let errorField=$(`#${errorFieldName}`);\r\n  let field=$(`#${fieldname}`);\r\n  \r\n  if (!errorField || errorField.length ==0) {\r\n    field.after(`<div id=\"${errorFieldName}\" class=\"invalid-feedback\"></div>`);\r\n    errorField=$(`#${errorFieldName}`);\r\n  }\r\n  if(error.length ==0){\r\n      errorField.hide();\r\n      field.removeClass('is-invalid');\r\n      field.addClass('is-valid');\r\n      errorField.text('');\r\n  }\r\n  else {     \r\n      errorField.show();\r\n      errorField.text(error);\r\n      field.removeClass('is-valid');\r\n      field.addClass('is-invalid');\r\n  }\r\n  return errorField;\r\n}\r\n$(document).ready(function () {\r\n  $('.material-icons').each(function (_index, entry) {\r\n    entry.attributes['icon'] = entry.textContent;\r\n  });\r\n  setIcons(true);\r\n  handleNVSVisible();\r\n  flashState.init();\r\n  $('#fw-url-input').on('input', function () {\r\n    if ($(this).val().length > 8 && ($(this).val().startsWith('http://') || $(this).val().startsWith('https://'))) {\r\n      $('#start-flash').show();\r\n    }\r\n    else {\r\n      $('#start-flash').hide();\r\n    }\r\n  });\r\n  $('.upSrch').on('input', function () {\r\n    const val = this.value;\r\n    $(\"#rTable tr\").removeClass(this.id + '_hide');\r\n    if (val.length > 0) {\r\n      $(`#rTable td:nth-child(${$(this).parent().index() + 1})`).filter(function () {\r\n        return !$(this).text().toUpperCase().includes(val.toUpperCase());\r\n      }).parent().addClass(this.id + '_hide');\r\n    }\r\n    $('[class*=\"_hide\"]').hide();\r\n    $('#rTable tr').not('[class*=\"_hide\"]').show()\r\n\r\n  });\r\n  setTimeout(refreshAP, 1500);\r\n  /* add validation for cmd_opt_c, which accepts a comma separated list. \r\n    getting known codecs from validOptions.codecs array\r\n    use bootstrap classes to highlight the error with an overlay message */\r\n  $('#options input').on('input', function () {\r\n    const { opt, val } = get_control_option_value(this);\r\n    if (opt === 'c' || opt === 'e') {\r\n      const fieldname = `cmd_opt_${opt}_codec-error`;\r\n      \r\n      const values = val.split(',').map(function (item) {\r\n        return item.trim();\r\n      });\r\n      /* get a list of invalid codecs */\r\n      const invalid = values.filter(function (item) {\r\n        return !validOptions.codecs.includes(item);\r\n      });\r\n      renderError(opt,invalid.length > 0 ? `Invalid codec(s) ${invalid.join(', ')}` : '');\r\n    }\r\n    /* add validation for cmd_opt_m, which accepts a mac_address */\r\n    if (opt === 'm') {\r\n      const mac_regex = /^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;\r\n      renderError(opt,mac_regex.test(val) ? '' : 'Invalid MAC address');\r\n    }\r\n    if (opt === 'r') {\r\n        const rateRegex =  /^(\\d+\\.?\\d*|\\.\\d+)-(\\d+\\.?\\d*|\\.\\d+)$|^(\\d+\\.?\\d*)$|^(\\d+\\.?\\d*,)+\\d+\\.?\\d*$/;\r\n        renderError(opt,rateRegex.test(val)?'':`Invalid rate(s) ${val}. Acceptable format: <maxrate>|<minrate>-<maxrate>|<rate1>,<rate2>,<rate3>`);\r\n    }\r\n\r\n\r\n\r\n  }\r\n\r\n\r\n  );\r\n\r\n\r\n\r\n\r\n\r\n  $('#WifiConnectDialog')[0].addEventListener('shown.bs.modal', function (event) {\r\n    $(\"*[class*='connecting']\").hide();\r\n\r\n    if (event?.relatedTarget) {\r\n      ConnectingToSSID.Action = ConnectingToActions.CONN;\r\n      if ($(event.relatedTarget).children('td:eq(1)').text() == ConnectedTo.ssid) {\r\n        ConnectingToSSID.Action = ConnectingToActions.STS;\r\n      }\r\n      else {\r\n        if (!$(event.relatedTarget).is(':last-child')) {\r\n          ConnectingToSSID.ssid = $(event.relatedTarget).children('td:eq(1)').text();\r\n          $('#manual_ssid').val(ConnectingToSSID.ssid);\r\n        }\r\n        else {\r\n          ConnectingToSSID.Action = ConnectingToActions.MAN;\r\n          ConnectingToSSID.ssid = '';\r\n          $('#manual_ssid').val(ConnectingToSSID.ssid);\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    if (ConnectingToSSID.Action !== ConnectingToActions.STS) {\r\n      $('.connecting-init').show();\r\n      $('#manual_ssid').trigger('focus');\r\n    }\r\n    else {\r\n      handleWifiDialog();\r\n    }\r\n  });\r\n\r\n  $('#WifiConnectDialog')[0].addEventListener('hidden.bs.modal', function () {\r\n    $('#WifiConnectDialog input').val('');\r\n  });\r\n\r\n  $('#uCnfrm')[0].addEventListener('shown.bs.modal', function () {\r\n    $('#selectedFWURL').text($('#fw-url-input').val());\r\n  });\r\n\r\n  $('input#show-commands')[0].checked = LastCommandsState === 1;\r\n  $('a[href^=\"#tab-commands\"]').hide();\r\n  $('#load-nvs').on('click', function () {\r\n    $('#nvsfilename').trigger('click');\r\n  });\r\n  $('#nvsfilename').on('change', function () {\r\n    if (typeof window.FileReader !== 'function') {\r\n      throw \"The file API isn't supported on this browser.\";\r\n    }\r\n    if (!this.files) {\r\n      throw 'This browser does not support the `files` property of the file input.';\r\n    }\r\n    if (!this.files[0]) {\r\n      return undefined;\r\n    }\r\n\r\n    const file = this.files[0];\r\n    let fr = new FileReader();\r\n    fr.onload = function (e) {\r\n      let data = {};\r\n      try {\r\n        data = JSON.parse(e.target.result);\r\n      } catch (ex) {\r\n        alert('Parsing failed!\\r\\n ' + ex);\r\n      }\r\n      $('input.nvs').each(function (_index, entry) {\r\n        $(this).parent().removeClass('bg-warning').removeClass('bg-success');\r\n        if (data[entry.id]) {\r\n          if (data[entry.id] !== entry.value) {\r\n            console.log(\r\n              'Changed ' + entry.id + ' ' + entry.value + '==>' + data[entry.id]\r\n            );\r\n            $(this).parent().addClass('bg-warning');\r\n            $(this).val(data[entry.id]);\r\n          }\r\n          else {\r\n            $(this).parent().addClass('bg-success');\r\n          }\r\n        }\r\n      });\r\n      var changed = $(\"input.nvs\").children('.bg-warning');\r\n      if (changed) {\r\n        alert('Highlighted values were changed. Press Commit to change on the device');\r\n      }\r\n    }\r\n    fr.readAsText(file);\r\n    this.value = null;\r\n\r\n  }\r\n  );\r\n  $('#clear-syslog').on('click', function () {\r\n    messagecount = 0;\r\n    messageseverity = 'MESSAGING_INFO';\r\n    $('#msgcnt').text('');\r\n    $('#syslogTable').html('');\r\n  });\r\n\r\n  $('#ok-credits').on('click', function () {\r\n    $('#credits').slideUp('fast', function () { });\r\n    $('#app').slideDown('fast', function () { });\r\n  });\r\n\r\n  $('#acredits').on('click', function (event) {\r\n    event.preventDefault();\r\n    $('#app').slideUp('fast', function () { });\r\n    $('#credits').slideDown('fast', function () { });\r\n  });\r\n\r\n  $('input#show-commands').on('click', function () {\r\n    this.checked = this.checked ? 1 : 0;\r\n    if (this.checked) {\r\n      $('a[href^=\"#tab-commands\"]').show();\r\n      LastCommandsState = 1;\r\n    } else {\r\n      LastCommandsState = 0;\r\n      $('a[href^=\"#tab-commands\"]').hide();\r\n    }\r\n  });\r\n\r\n  $('input#show-nvs').on('click', function () {\r\n    this.checked = this.checked ? 1 : 0;\r\n    Cookies.set(\"show-nvs\", this.checked ? 'Y' : 'N');\r\n    handleNVSVisible();\r\n  });\r\n  $('#btn_reboot_recovery').on('click', function () {\r\n    handleReboot('recovery');\r\n  });\r\n  $('#btn_reboot').on('click', function () {\r\n    handleReboot('reboot');\r\n  });\r\n  $('#btn_flash').on('click', function () {\r\n    hFlash();\r\n  });\r\n  $('#save-autoexec1').on('click', function () {\r\n    saveAutoexec1(false);\r\n  });\r\n  $('#commit-autoexec1').on('click', function () {\r\n    saveAutoexec1(true);\r\n  });\r\n  $('#btn_disconnect').on('click', function () {\r\n    ConnectedTo = {};\r\n    refreshAPHTML2();\r\n    $.ajax({\r\n      url: '/connect.json',\r\n      dataType: 'text',\r\n      method: 'DELETE',\r\n      cache: false,\r\n      contentType: 'application/json; charset=utf-8',\r\n      data: JSON.stringify({\r\n        timestamp: Date.now(),\r\n      }),\r\n    });\r\n  });\r\n  $('#btnJoin').on('click', function () {\r\n    handleConnect();\r\n  });\r\n  $('#reboot_nav').on('click', function () {\r\n    handleReboot('reboot');\r\n  });\r\n  $('#reboot_ota_nav').on('click', function () {\r\n    handleReboot('reboot_ota');\r\n  });\r\n\r\n  $('#save-as-nvs').on('click', function () {\r\n    const config = getConfigJson(true);\r\n    const a = document.createElement('a');\r\n    a.href = URL.createObjectURL(\r\n      new Blob([JSON.stringify(config, null, 2)], {\r\n        type: 'text/plain',\r\n      })\r\n    );\r\n    a.setAttribute(\r\n      'download',\r\n      'nvs_config_' + hostName + '_' + Date.now() + 'json'\r\n    );\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n  });\r\n\r\n  $('#save-nvs').on('click', function () {\r\n    post_config(getConfigJson(false));\r\n  });\r\n\r\n  $('#fwUpload').on('click', function () {\r\n    const fileInput = document.getElementById('flashfilename').files;\r\n    if (fileInput.length === 0) {\r\n      alert('No file selected!');\r\n    } else {\r\n      $('#fw-url-input').value = null;\r\n      flashState.StartOTA();\r\n    }\r\n\r\n  });\r\n  $('[name=output-tmpl]').on('click', function () {\r\n    handleTemplateTypeRadio(this.id);\r\n  });\r\n\r\n  $('#chkUpdates').on('click', function () {\r\n    $('#rTable').html('');\r\n    $.getJSON(releaseURL, function (data) {\r\n      let i = 0;\r\n      const branches = [];\r\n      data.forEach(function (release) {\r\n        const namecomponents = release.name.split('#');\r\n        const branch = namecomponents[3];\r\n        if (!branches.includes(branch)) {\r\n          branches.push(branch);\r\n        }\r\n      });\r\n      let fwb = '';\r\n      branches.forEach(function (branch) {\r\n        fwb += '<option value=\"' + branch + '\">' + branch + '</option>';\r\n      });\r\n      $('#fwbranch').append(fwb);\r\n\r\n      data.forEach(function (release) {\r\n        let url = '';\r\n        release.assets.forEach(function (asset) {\r\n          if (asset.name.match(/\\.bin$/)) {\r\n            url = asset.browser_download_url;\r\n          }\r\n        });\r\n        const namecomponents = release.name.split('#');\r\n        const ver = namecomponents[0];\r\n        const cfg = namecomponents[2];\r\n        const branch = namecomponents[3];\r\n        var bits = ver.substr(ver.lastIndexOf('-') + 1);\r\n        bits = (bits == '32' || bits == '16') ? bits : '';\r\n\r\n        let body = release.body;\r\n        body = body.replace(/'/gi, '\"');\r\n        body = body.replace(\r\n          /[\\s\\S]+(### Revision Log[\\s\\S]+)### ESP-IDF Version Used[\\s\\S]+/,\r\n          '$1'\r\n        );\r\n        body = body.replace(/- \\(.+?\\) /g, '- ').encodeHTML();\r\n        $('#rTable').append(`<tr class='release ' fwurl='${url}'>\r\n        <td data-bs-toggle='tooltip' title='${body}'>${ver}</td><td>${new Date(release.created_at).toLocalShort()}\r\n        </td><td class='upf'>${cfg}</td><td>${branch}</td><td>${bits}</td></tr>`\r\n        );\r\n      });\r\n      if (i > 7) {\r\n        $('#releaseTable').append(\r\n          \"<tr id='showall'>\" +\r\n          \"<td colspan='6'>\" +\r\n          \"<input type='button' id='showallbutton' class='btn btn-info' value='Show older releases' />\" +\r\n          '</td>' +\r\n          '</tr>'\r\n        );\r\n        $('#showallbutton').on('click', function () {\r\n          $('tr.hide').removeClass('hide');\r\n          $('tr#showall').addClass('hide');\r\n        });\r\n      }\r\n      $('#searchfw').css('display', 'inline');\r\n      if (!setPlatformFilter(platform_name)) {\r\n        setPlatformFilter(project_name)\r\n      }\r\n      $('#rTable tr.release').on('click', function () {\r\n        var url = this.attributes['fwurl'].value;\r\n        if (lmsBaseUrl) {\r\n          url = url.replace(/.*\\/download\\//, lmsBaseUrl + '/plugins/SqueezeESP32/firmware/');\r\n        }\r\n        $('#fw-url-input').val(url);\r\n        $('#start-flash').show();\r\n        $('#rTable tr.release').removeClass('table-success table-warning');\r\n        $(this).addClass('table-success table-warning');\r\n      });\r\n\r\n    }).fail(function () {\r\n      alert('failed to fetch release history!');\r\n    });\r\n  });\r\n  $('#fwcheck').on('click', function () {\r\n    $('#releaseTable').html('');\r\n    $('#fwbranch').empty();\r\n    $.getJSON(releaseURL, function (data) {\r\n      let i = 0;\r\n      const branches = [];\r\n      data.forEach(function (release) {\r\n        const namecomponents = release.name.split('#');\r\n        const branch = namecomponents[3];\r\n        if (!branches.includes(branch)) {\r\n          branches.push(branch);\r\n        }\r\n      });\r\n      let fwb;\r\n      branches.forEach(function (branch) {\r\n        fwb += '<option value=\"' + branch + '\">' + branch + '</option>';\r\n      });\r\n      $('#fwbranch').append(fwb);\r\n\r\n      data.forEach(function (release) {\r\n        let url = '';\r\n        release.assets.forEach(function (asset) {\r\n          if (asset.name.match(/\\.bin$/)) {\r\n            url = asset.browser_download_url;\r\n          }\r\n        });\r\n        const namecomponents = release.name.split('#');\r\n        const ver = namecomponents[0];\r\n        const idf = namecomponents[1];\r\n        const cfg = namecomponents[2];\r\n        const branch = namecomponents[3];\r\n\r\n        let body = release.body;\r\n        body = body.replace(/'/gi, '\"');\r\n        body = body.replace(\r\n          /[\\s\\S]+(### Revision Log[\\s\\S]+)### ESP-IDF Version Used[\\s\\S]+/,\r\n          '$1'\r\n        );\r\n        body = body.replace(/- \\(.+?\\) /g, '- ');\r\n        const trclass = i++ > 6 ? ' hide' : '';\r\n        $('#releaseTable').append(\r\n          \"<tr class='release\" +\r\n          trclass +\r\n          \"'>\" +\r\n          \"<td data-bs-toggle='tooltip' title='\" +\r\n          body +\r\n          \"'>\" +\r\n          ver +\r\n          '</td>' +\r\n          '<td>' +\r\n          new Date(release.created_at).toLocalShort() +\r\n          '</td>' +\r\n          '<td>' +\r\n          cfg +\r\n          '</td>' +\r\n          '<td>' +\r\n          idf +\r\n          '</td>' +\r\n          '<td>' +\r\n          branch +\r\n          '</td>' +\r\n          \"<td><input type='button' class='btn btn-success' value='Select' data-bs-url='\" +\r\n          url +\r\n          \"' onclick='setURL(this);' /></td>\" +\r\n          '</tr>'\r\n        );\r\n      });\r\n      if (i > 7) {\r\n        $('#releaseTable').append(\r\n          \"<tr id='showall'>\" +\r\n          \"<td colspan='6'>\" +\r\n          \"<input type='button' id='showallbutton' class='btn btn-info' value='Show older releases' />\" +\r\n          '</td>' +\r\n          '</tr>'\r\n        );\r\n        $('#showallbutton').on('click', function () {\r\n          $('tr.hide').removeClass('hide');\r\n          $('tr#showall').addClass('hide');\r\n        });\r\n      }\r\n      $('#searchfw').css('display', 'inline');\r\n    }).fail(function () {\r\n      alert('failed to fetch release history!');\r\n    });\r\n  });\r\n\r\n  $('#updateAP').on('click', function () {\r\n    refreshAP();\r\n    console.log('refresh AP');\r\n  });\r\n\r\n  // first time the page loads: attempt to get the connection status and start the wifi scan\r\n  getConfig();\r\n  getCommands();\r\n  getMessages();\r\n  checkStatus();\r\n\r\n});\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nwindow.setURL = function (button) {\r\n  let url = button.dataset.url;\r\n\r\n  $('[data-bs-url^=\"http\"]')\r\n    .addClass('btn-success')\r\n    .removeClass('btn-danger');\r\n  $('[data-bs-url=\"' + url + '\"]')\r\n    .addClass('btn-danger')\r\n    .removeClass('btn-success');\r\n\r\n  // if user can proxy download through LMS, modify the URL\r\n  if (lmsBaseUrl) {\r\n    url = url.replace(/.*\\/download\\//, lmsBaseUrl + '/plugins/SqueezeESP32/firmware/');\r\n  }\r\n\r\n  $('#fwurl').val(url);\r\n}\r\n\r\n\r\nfunction rssiToIcon(rssi) {\r\n  if (rssi >= -55) {\r\n    return { 'label': '****', 'icon': `signal_wifi_statusbar_4_bar` };\r\n  } else if (rssi >= -60) {\r\n    return { 'label': '***', 'icon': `network_wifi_3_bar` };\r\n  } else if (rssi >= -65) {\r\n    return { 'label': '**', 'icon': `network_wifi_2_bar` };\r\n  } else if (rssi >= -70) {\r\n    return { 'label': '*', 'icon': `network_wifi_1_bar` };\r\n  } else {\r\n    return { 'label': '.', 'icon': `signal_wifi_statusbar_null` };\r\n  }\r\n}\r\n\r\nfunction refreshAP() {\r\n  if (ConnectedTo?.urc === connectReturnCode.ETH) return;\r\n  $.ajaxSetup({\r\n    timeout: 3000 //Time in milliseconds\r\n  });\r\n  $.getJSON('/scan.json', async function () {\r\n    await sleep(2000);\r\n    $.getJSON('/ap.json', function (data) {\r\n      if (data.length > 0) {\r\n        // sort by signal strength\r\n        data.sort(function (a, b) {\r\n          const x = a.rssi;\r\n          const y = b.rssi;\r\n          // eslint-disable-next-line no-nested-ternary\r\n          return x < y ? 1 : x > y ? -1 : 0;\r\n        });\r\n        apList = data;\r\n        refreshAPHTML2(apList);\r\n\r\n      }\r\n    });\r\n  });\r\n}\r\nfunction formatAP(ssid, rssi, auth) {\r\n  const rssi_icon = rssiToIcon(rssi);\r\n  const auth_icon = { label: auth == 0 ? '🔓' : '🔒', icon: auth == 0 ? 'no_encryption' : 'lock' };\r\n\r\n  return `<tr data-bs-toggle=\"modal\" data-bs-target=\"#WifiConnectDialog\"><td></td><td>${ssid}</td><td>\r\n  <span class=\"material-icons\" style=\"fill:white; display: inline\" aria-label=\"${rssi_icon.label}\" icon=\"${rssi_icon.icon}\" >${getIcon(rssi_icon)}</span>\r\n  \t</td><td>\r\n    <span class=\"material-icons\" aria-label=\"${auth_icon.label}\" icon=\"${auth_icon.icon}\">${getIcon(auth_icon)}</span>\r\n  </td></tr>`;\r\n}\r\nfunction refreshAPHTML2(data) {\r\n  let h = '';\r\n  $('#wifiTable tr td:first-of-type').text('');\r\n  $('#wifiTable tr').removeClass('table-success table-warning');\r\n  if (data) {\r\n    data.forEach(function (e) {\r\n      h += formatAP(e.ssid, e.rssi, e.auth);\r\n    });\r\n    $('#wifiTable').html(h);\r\n  }\r\n  if ($('.manual_add').length == 0) {\r\n    $('#wifiTable').append(formatAP('Manual add', 0, 0));\r\n    $('#wifiTable tr:last').addClass('table-light text-dark').addClass('manual_add');\r\n  }\r\n  if (ConnectedTo.ssid && (ConnectedTo.urc === connectReturnCode.OK || ConnectedTo.urc === connectReturnCode.RESTORE)) {\r\n    const wifiSelector = `#wifiTable td:contains(\"${ConnectedTo.ssid}\")`;\r\n    if ($(wifiSelector).filter(function () { return $(this).text() === ConnectedTo.ssid; }).length == 0) {\r\n      $('#wifiTable').prepend(`${formatAP(ConnectedTo.ssid, ConnectedTo.rssi ?? 0, 0)}`);\r\n    }\r\n    $(wifiSelector).filter(function () { return $(this).text() === ConnectedTo.ssid; }).siblings().first().html('&check;').parent().addClass((ConnectedTo.urc === connectReturnCode.OK ? 'table-success' : 'table-warning'));\r\n    $('span#foot-if').html(`SSID: <strong>${ConnectedTo.ssid}</strong>, IP: <strong>${ConnectedTo.ip}</strong>`);\r\n    $('#wifiStsIcon').html(rssiToIcon(ConnectedTo.rssi));\r\n\r\n  }\r\n  else if (ConnectedTo?.urc !== connectReturnCode.ETH) {\r\n    $('span#foot-if').html('');\r\n  }\r\n\r\n}\r\nfunction refreshETH() {\r\n\r\n  if (ConnectedTo.urc === connectReturnCode.ETH) {\r\n    $('span#foot-if').html(`Network: Ethernet, IP: <strong>${ConnectedTo.ip}</strong>`);\r\n  }\r\n}\r\nfunction showTask(task) {\r\n  console.debug(\r\n    this.toLocaleString() +\r\n    '\\t' +\r\n    task.nme +\r\n    '\\t' +\r\n    task.cpu +\r\n    '\\t' +\r\n    taskStates[task.st] +\r\n    '\\t' +\r\n    task.minstk +\r\n    '\\t' +\r\n    task.bprio +\r\n    '\\t' +\r\n    task.cprio +\r\n    '\\t' +\r\n    task.num\r\n  );\r\n  $('tbody#tasks').append(\r\n    '<tr class=\"table-primary\"><th scope=\"row\">' +\r\n    task.num +\r\n    '</th><td>' +\r\n    task.nme +\r\n    '</td><td>' +\r\n    task.cpu +\r\n    '</td><td>' +\r\n    taskStates[task.st] +\r\n    '</td><td>' +\r\n    task.minstk +\r\n    '</td><td>' +\r\n    task.bprio +\r\n    '</td><td>' +\r\n    task.cprio +\r\n    '</td></tr>'\r\n  );\r\n}\r\nfunction btExists(name) {\r\n  return getBTSinkOpt(name).length > 0;\r\n}\r\nfunction getBTSinkOpt(name) {\r\n  return $(`${btSinkNamesOptSel} option:contains('${name}')`);\r\n}\r\nfunction getMessages() {\r\n  $.ajaxSetup({\r\n    timeout: messageInterval //Time in milliseconds\r\n  });\r\n  $.getJSON('/messages.json', async function (data) {\r\n    for (const msg of data) {\r\n      const msgAge = msg.current_time - msg.sent_time;\r\n      var msgTime = new Date();\r\n      msgTime.setTime(msgTime.getTime() - msgAge);\r\n      switch (msg.class) {\r\n        case 'MESSAGING_CLASS_OTA':\r\n          flashState.EventOTAMessageClass(msg.message);\r\n          break;\r\n        case 'MESSAGING_CLASS_STATS':\r\n          // for task states, check structure : task_state_t\r\n          var statsData = JSON.parse(msg.message);\r\n          console.debug(\r\n            msgTime.toLocalShort() +\r\n            ' - Number of running tasks: ' +\r\n            statsData.ntasks\r\n          );\r\n          console.debug(\r\n            msgTime.toLocalShort() +\r\n            '\\tname' +\r\n            '\\tcpu' +\r\n            '\\tstate' +\r\n            '\\tminstk' +\r\n            '\\tbprio' +\r\n            '\\tcprio' +\r\n            '\\tnum'\r\n          );\r\n          if (statsData.tasks) {\r\n            if ($('#tasks_sect').css('visibility') === 'collapse') {\r\n              $('#tasks_sect').css('visibility', 'visible');\r\n            }\r\n            $('tbody#tasks').html('');\r\n            statsData.tasks\r\n              .sort(function (a, b) {\r\n                return b.cpu - a.cpu;\r\n              })\r\n              .forEach(showTask, msgTime);\r\n          } else if ($('#tasks_sect').css('visibility') === 'visible') {\r\n            $('tbody#tasks').empty();\r\n            $('#tasks_sect').css('visibility', 'collapse');\r\n          }\r\n          break;\r\n        case 'MESSAGING_CLASS_SYSTEM':\r\n          showMessage(msg, msgTime);\r\n          break;\r\n        case 'MESSAGING_CLASS_CFGCMD':\r\n          var msgparts = msg.message.split(/([^\\n]*)\\n(.*)/gs);\r\n          showCmdMessage(msgparts[1], msg.type, msgparts[2], true);\r\n          break;\r\n        case 'MESSAGING_CLASS_BT':\r\n          if ($(\"#cfg-audio-bt_source-sink_name\").is('input')) {\r\n            var attr = $(\"#cfg-audio-bt_source-sink_name\")[0].attributes;\r\n            var attrs = '';\r\n            for (var j = 0; j < attr.length; j++) {\r\n              if (attr.item(j).name != \"type\") {\r\n                attrs += `${attr.item(j).name} = \"${attr.item(j).value}\" `;\r\n              }\r\n            }\r\n            var curOpt = $(\"#cfg-audio-bt_source-sink_name\")[0].value;\r\n            $(\"#cfg-audio-bt_source-sink_name\").replaceWith(`<select id=\"cfg-audio-bt_source-sink_name\" ${attrs}><option value=\"${curOpt}\" data-bs-description=\"${curOpt}\">${curOpt}</option></select> `);\r\n          }\r\n          JSON.parse(msg.message).forEach(function (btEntry) {\r\n            //<input type=\"text\" class=\"form-control bg-success\" placeholder=\"name\" hasvalue=\"true\" longopts=\"sink_name\" shortopts=\"n\" checkbox=\"false\" cmdname=\"cfg-audio-bt_source\" id=\"cfg-audio-bt_source-sink_name\" name=\"cfg-audio-bt_source-sink_name\">\r\n            //<select hasvalue=\"true\" longopts=\"jack_behavior\" shortopts=\"j\" checkbox=\"false\" cmdname=\"cfg-audio-general\" id=\"cfg-audio-general-jack_behavior\" name=\"cfg-audio-general-jack_behavior\" class=\"form-control \"><option>--</option><option>Headphones</option><option>Subwoofer</option></select>            \r\n            if (!btExists(btEntry.name)) {\r\n              $(\"#cfg-audio-bt_source-sink_name\").append(`<option>${btEntry.name}</option>`);\r\n              showMessage({ type: msg.type, message: `BT Audio device found: ${btEntry.name} RSSI: ${btEntry.rssi} ` }, msgTime);\r\n            }\r\n            getBTSinkOpt(btEntry.name).attr('data-bs-description', `${btEntry.name} (${btEntry.rssi}dB)`)\r\n              .attr('rssi', btEntry.rssi)\r\n              .attr('value', btEntry.name)\r\n              .text(`${btEntry.name} [${btEntry.rssi}dB]`).trigger('change');\r\n\r\n          });\r\n          $(btSinkNamesOptSel).append($(`${btSinkNamesOptSel} option`).remove().sort(function (a, b) {\r\n            console.log(`${parseInt($(a).attr('rssi'))} < ${parseInt($(b).attr('rssi'))} ? `);\r\n            return parseInt($(a).attr('rssi')) < parseInt($(b).attr('rssi')) ? 1 : -1;\r\n          }));\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n    setTimeout(getMessages, messageInterval);\r\n  }).fail(function (xhr, ajaxOptions, thrownError) {\r\n\r\n    if (xhr.status == 404) {\r\n      $('.orec').hide(); // system commands won't be available either\r\n      messagesHeld = true;\r\n    }\r\n    else {\r\n      handleExceptionResponse(xhr, ajaxOptions, thrownError);\r\n    }\r\n    if (xhr.status == 0 && xhr.readyState == 0) {\r\n      // probably a timeout. Target is rebooting? \r\n      setTimeout(getMessages, messageInterval * 2); // increase duration if a failure happens\r\n    }\r\n    else if (!messagesHeld) {\r\n      // 404 here means we rebooted to an old recovery\r\n      setTimeout(getMessages, messageInterval); // increase duration if a failure happens\r\n    }\r\n\r\n  }\r\n  );\r\n\r\n  /*\r\n    Minstk is minimum stack space left\r\nBprio is base priority\r\ncprio is current priority\r\nnme is name\r\nst is task state. I provided a \"typedef\" that you can use to convert to text\r\ncpu is cpu percent used\r\n*/\r\n}\r\nfunction handleRecoveryMode(data) {\r\n  const locRecovery = data.recovery ?? 0;\r\n  if (locRecovery === 1) {\r\n    recovery = true;\r\n    $('.recovery_element').show();\r\n    $('.ota_element').hide();\r\n    $('#boot-button').html('Reboot');\r\n    $('#boot-form').attr('action', '/reboot_ota.json');\r\n  } else {\r\n    if (!recovery && messagesHeld) {\r\n      messagesHeld = false;\r\n      setTimeout(getMessages, messageInterval); // increase duration if a failure happens\r\n    }\r\n    recovery = false;\r\n\r\n    $('.recovery_element').hide();\r\n    $('.ota_element').show();\r\n    $('#boot-button').html('Recovery');\r\n    $('#boot-form').attr('action', '/recovery.json');\r\n  }\r\n\r\n}\r\n\r\nfunction hasConnectionChanged(data) {\r\n  // gw: \"192.168.10.1\"\r\n  // ip: \"192.168.10.225\"\r\n  // netmask: \"255.255.255.0\"\r\n  // ssid: \"MyTestSSID\"\r\n\r\n  return (data.urc !== ConnectedTo.urc ||\r\n    data.ssid !== ConnectedTo.ssid ||\r\n    data.gw !== ConnectedTo.gw ||\r\n    data.netmask !== ConnectedTo.netmask ||\r\n    data.ip !== ConnectedTo.ip || data.rssi !== ConnectedTo.rssi)\r\n}\r\nfunction handleWifiDialog(data) {\r\n  if ($('#WifiConnectDialog').is(':visible')) {\r\n    if (ConnectedTo.ip) {\r\n      $('#ipAddress').text(ConnectedTo.ip);\r\n    }\r\n    if (ConnectedTo.ssid) {\r\n      $('#connectedToSSID').text(ConnectedTo.ssid);\r\n    }\r\n    if (ConnectedTo.gw) {\r\n      $('#gateway').text(ConnectedTo.gw);\r\n    }\r\n    if (ConnectedTo.netmask) {\r\n      $('#netmask').text(ConnectedTo.netmask);\r\n    }\r\n    if (ConnectingToSSID.Action === undefined || (ConnectingToSSID.Action && ConnectingToSSID.Action == ConnectingToActions.STS)) {\r\n      $(\"*[class*='connecting']\").hide();\r\n      $('.connecting-status').show();\r\n    }\r\n    if (SystemConfig.ap_ssid) {\r\n      $('#apName').text(SystemConfig.ap_ssid.value);\r\n    }\r\n    if (SystemConfig.ap_pwd) {\r\n      $('#apPass').text(SystemConfig.ap_pwd.value);\r\n    }\r\n    if (!data) {\r\n      return;\r\n    }\r\n    else {\r\n      switch (data.urc) {\r\n        case connectReturnCode.OK:\r\n          if (data.ssid && data.ssid === ConnectingToSSID.ssid) {\r\n            $(\"*[class*='connecting']\").hide();\r\n            $('.connecting-success').show();\r\n            ConnectingToSSID.Action = ConnectingToActions.STS;\r\n          }\r\n          break;\r\n        case connectReturnCode.FAIL:\r\n          // \r\n          if (ConnectingToSSID.Action != ConnectingToActions.STS && ConnectingToSSID.ssid == data.ssid) {\r\n            $(\"*[class*='connecting']\").hide();\r\n            $('.connecting-fail').show();\r\n          }\r\n          break;\r\n        case connectReturnCode.LOST:\r\n\r\n          break;\r\n        case connectReturnCode.RESTORE:\r\n          if (ConnectingToSSID.Action != ConnectingToActions.STS && ConnectingToSSID.ssid != data.ssid) {\r\n            $(\"*[class*='connecting']\").hide();\r\n            $('.connecting-fail').show();\r\n          }\r\n          break;\r\n        case connectReturnCode.DISC:\r\n          // that's a manual disconnect\r\n          // if ($('#wifi-status').is(':visible')) {\r\n          //   $('#wifi-status').slideUp('fast', function() {});\r\n          //   $('span#foot-wifi').html('');\r\n\r\n          // }                 \r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n  }\r\n}\r\nfunction setIcons(offline) {\r\n  $('.material-icons').each(function (_index, entry) {\r\n    entry.textContent = entry.attributes[offline ? 'aria-label' : 'icon'].value;\r\n  });\r\n}\r\nfunction handleNetworkStatus(data) {\r\n  setIcons(!isConnected());\r\n  if (hasConnectionChanged(data) || !data.urc) {\r\n    ConnectedTo = data;\r\n    $(\".if_eth\").hide();\r\n    $('.if_wifi').hide();\r\n    if (!data.urc || ConnectedTo.urc != connectReturnCode.ETH) {\r\n      $('.if_wifi').show();\r\n      refreshAPHTML2();\r\n    }\r\n    else {\r\n      $(\".if_eth\").show();\r\n      refreshETH();\r\n    }\r\n\r\n  }\r\n  handleWifiDialog(data);\r\n}\r\n\r\n\r\n\r\nfunction batteryToIcon(voltage) {\r\n  /* Assuming Li-ion 18650s as a power source, 3.9V per cell, or above is treated\r\n  as full charge (>75% of capacity).  3.4V is empty. The gauge is loosely\r\n  following the graph here:\r\n    https://learn.adafruit.com/li-ion-and-lipoly-batteries/voltages\r\n  using the 0.2C discharge profile for the rest of the values.\r\n*/\r\n\r\n  for (const iconEntry of batIcons) {\r\n    for (const entryRanges of iconEntry.ranges) {\r\n      if (inRange(voltage, entryRanges.f, entryRanges.t)) {\r\n        return { label: iconEntry.label, icon: iconEntry.icon };\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  return { label: '▪▪▪▪', icon: \"battery_full\" };\r\n}\r\nfunction checkStatus() {\r\n  $.ajaxSetup({\r\n    timeout: statusInterval //Time in milliseconds\r\n  });\r\n  $.getJSON('/status.json', function (data) {\r\n    handleRecoveryMode(data);\r\n    handleNVSVisible();\r\n    handleNetworkStatus(data);\r\n    handlebtstate(data);\r\n    flashState.EventTargetStatus(data);\r\n    if(data.depth) {\r\n      depth = data.depth;\r\n      if(depth==16){\r\n        $('#cmd_opt_R').show();\r\n      }\r\n      else{\r\n        $('#cmd_opt_R').hide();\r\n      }\r\n    }\r\n\r\n\r\n    if (data.project_name && data.project_name !== '') {\r\n      project_name = data.project_name;\r\n    }\r\n    if (data.platform_name && data.platform_name !== '') {\r\n      platform_name = data.platform_name;\r\n    }\r\n    if (board_model === '') board_model = project_name;\r\n    if (board_model === '') board_model = 'Squeezelite-ESP32';\r\n    if (data.version && data.version !== '') {\r\n      versionName = data.version;\r\n      $(\"#navtitle\").html(`${board_model}${recovery ? '<br>[recovery]' : ''}`);\r\n      $('span#foot-fw').html(`fw: <strong>${versionName}</strong>, mode: <strong>${recovery ? \"Recovery\" : project_name}</strong>`);\r\n    } else {\r\n      $('span#flash-status').html('');\r\n    }\r\n    if (data.Voltage) {\r\n      const bat_icon = batteryToIcon(data.Voltage);\r\n      $('#battery').html(`${getIcon(bat_icon)}`);\r\n      $('#battery').attr(\"aria-label\", bat_icon.label);\r\n      $('#battery').attr(\"icon\", bat_icon.icon);\r\n      $('#battery').show();\r\n    } else {\r\n      $('#battery').hide();\r\n    }\r\n    if ((data.message ?? '') != '' && prevmessage != data.message) {\r\n      // supporting older recovery firmwares - messages will come from the status.json structure\r\n      prevmessage = data.message;\r\n      showLocalMessage(data.message, 'MESSAGING_INFO')\r\n    }\r\n    is_i2c_locked = data.is_i2c_locked;\r\n    if (is_i2c_locked) {\r\n      $('flds-cfg-hw-preset').hide();\r\n    }\r\n    else {\r\n      $('flds-cfg-hw-preset').show();\r\n    }\r\n    $(\"button[onclick*='handleReboot']\").removeClass('rebooting');\r\n\r\n    if (typeof lmsBaseUrl == \"undefined\" || data.lms_ip != prevLMSIP && data.lms_ip && data.lms_port) {\r\n      const baseUrl = 'http://' + data.lms_ip + ':' + data.lms_port;\r\n      prevLMSIP = data.lms_ip;\r\n      $.ajax({\r\n        url: baseUrl + '/plugins/SqueezeESP32/firmware/-check.bin',\r\n        type: 'HEAD',\r\n        dataType: 'text',\r\n        cache: false,\r\n        error: function () {\r\n          // define the value, so we don't check it any more.\r\n          lmsBaseUrl = '';\r\n        },\r\n        success: function () {\r\n          lmsBaseUrl = baseUrl;\r\n        }\r\n      });\r\n    }\r\n    $('#o_jack').css({ display: Number(data.Jack) ? 'inline' : 'none' });\r\n    setTimeout(checkStatus, statusInterval);\r\n  }).fail(function (xhr, ajaxOptions, thrownError) {\r\n    handleExceptionResponse(xhr, ajaxOptions, thrownError);\r\n    if (xhr.status == 0 && xhr.readyState == 0) {\r\n      // probably a timeout. Target is rebooting? \r\n      setTimeout(checkStatus, messageInterval * 2); // increase duration if a failure happens\r\n    }\r\n    else {\r\n      setTimeout(checkStatus, messageInterval); // increase duration if a failure happens\r\n    }\r\n  });\r\n}\r\n// eslint-disable-next-line no-unused-vars\r\nwindow.runCommand = function (button, reboot) {\r\n  let cmdstring = button.attributes.cmdname.value;\r\n  showCmdMessage(\r\n    button.attributes.cmdname.value,\r\n    'MESSAGING_INFO',\r\n    'Executing.',\r\n    false\r\n  );\r\n  const fields = document.getElementById('flds-' + cmdstring);\r\n  const allfields = fields?.querySelectorAll('select,input');\r\n  if (cmdstring === 'cfg-hw-preset') return handleHWPreset(allfields, reboot);\r\n  cmdstring += ' ';\r\n  if (fields) {\r\n    for (const field of allfields) {\r\n      let qts = '';\r\n      let opt = '';\r\n      let attr = field.attributes;\r\n      let isSelect = $(field).is('select');\r\n      const hasValue = attr?.hasvalue?.value === 'true';\r\n      const validVal = (isSelect && field.value !== '--') || (!isSelect && field.value !== '');\r\n\r\n      if (!hasValue || hasValue && validVal) {\r\n        if (attr?.longopts?.value !== 'undefined') {\r\n          opt += '--' + attr?.longopts?.value;\r\n        } else if (attr?.shortopts?.value !== 'undefined') {\r\n          opt = '-' + attr.shortopts.value;\r\n        }\r\n\r\n        if (attr?.hasvalue?.value === 'true') {\r\n          if (attr?.value !== '') {\r\n            qts = /\\s/.test(field.value) ? '\"' : '';\r\n            cmdstring += opt + ' ' + qts + field.value + qts + ' ';\r\n          }\r\n        } else {\r\n          // this is a checkbox\r\n          if (field?.checked) {\r\n            cmdstring += opt + ' ';\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  console.log(cmdstring);\r\n\r\n  const data = {\r\n    timestamp: Date.now(),\r\n  };\r\n  data.command = cmdstring;\r\n\r\n  $.ajax({\r\n    url: '/commands.json',\r\n    dataType: 'text',\r\n    method: 'POST',\r\n    cache: false,\r\n    contentType: 'application/json; charset=utf-8',\r\n    data: JSON.stringify(data),\r\n    error: function (xhr, _ajaxOptions, thrownError) {\r\n      var cmd = JSON.parse(this.data).command;\r\n      if (xhr.status == 404) {\r\n        showCmdMessage(\r\n          cmd.substr(0, cmd.indexOf(' ')),\r\n          'MESSAGING_ERROR',\r\n          `${recovery ? 'Limited recovery mode active. Unsupported action ' : 'Unexpected error while processing command'}`,\r\n          true\r\n        );\r\n      }\r\n      else {\r\n        handleExceptionResponse(xhr, _ajaxOptions, thrownError);\r\n        showCmdMessage(\r\n          cmd.substr(0, cmd.indexOf(' ') - 1),\r\n          'MESSAGING_ERROR',\r\n          `Unexpected error ${(thrownError !== '') ? thrownError : 'with return status = ' + xhr.status}`,\r\n          true\r\n        );\r\n      }\r\n    },\r\n    success: function (response) {\r\n      $('.orec').show();\r\n      console.log(response);\r\n      if (\r\n        JSON.parse(response).Result === 'Success' &&\r\n        reboot\r\n      ) {\r\n        delayReboot(2500, button.attributes.cmdname.value);\r\n      }\r\n    },\r\n  });\r\n}\r\nfunction getLongOps(data, name, longopts) {\r\n  return data.values[name] !== undefined ? data.values[name][longopts] : \"\";\r\n}\r\nfunction getCommands() {\r\n  $.ajaxSetup({\r\n    timeout: 7000 //Time in milliseconds\r\n  });\r\n  $.getJSON('/commands.json', function (data) {\r\n    console.log(data);\r\n    $('.orec').show();\r\n    data.commands.forEach(function (command) {\r\n      if ($('#flds-' + command.name).length === 0) {\r\n        const cmdParts = command.name.split('-');\r\n        const isConfig = cmdParts[0] === 'cfg';\r\n        const targetDiv = '#tab-' + cmdParts[0] + '-' + cmdParts[1];\r\n        let innerhtml = '';\r\n        innerhtml += `<div class=\"card mb-3\"><div class=\"card-header\">${command.help.encodeHTML().replace(/\\n/g, '<br />')}</div><div class=\"card-body\"><fieldset id=\"flds-${command.name}\">`;\r\n        if (command.argtable) {\r\n          command.argtable.forEach(function (arg) {\r\n            let placeholder = arg.datatype || '';\r\n            const ctrlname = command.name + '-' + arg.longopts;\r\n            const curvalue = getLongOps(data, command.name, arg.longopts);\r\n\r\n            let attributes = 'hasvalue=' + arg.hasvalue + ' ';\r\n            attributes += 'longopts=\"' + arg.longopts + '\" ';\r\n            attributes += 'shortopts=\"' + arg.shortopts + '\" ';\r\n            attributes += 'checkbox=' + arg.checkbox + ' ';\r\n            attributes += 'cmdname=\"' + command.name + '\" ';\r\n            attributes += 'id=\"' + ctrlname + '\" name=\"' + ctrlname + '\" ';\r\n            if (arg.longopts && arg.longopts.startsWith('_')){\r\n              attributes += \"readonly \";\r\n            }\r\n            let extraclass = arg.mincount > 0 ? 'is-invalid' : '';\r\n            if (arg.glossary === 'hidden') {\r\n              attributes += ' style=\"visibility: hidden;\"';\r\n            }\r\n            if (arg.checkbox) {\r\n              innerhtml += `<div class=\"form-check\"><label class=\"form-check-label\"><input type=\"checkbox\" ${attributes} class=\"form-check-input ${extraclass}\" value=\"\" >${arg.glossary.encodeHTML()}</label></div><div>`;\r\n            } else if (arg.remark) {\r\n              innerhtml += `<div class=\"form-group\"><label for=\"${ctrlname}\">${arg.glossary.encodeHTML()}</label>`;\r\n            } else {\r\n              innerhtml += `<div class=\"form-group\" ><label for=\"${ctrlname}\">${arg.glossary.encodeHTML()}</label>`;\r\n              if (placeholder.includes('|')) {\r\n                extraclass = placeholder.startsWith('+') ? ' multiple ' : '';\r\n                placeholder = placeholder\r\n                  .replace('<', '')\r\n                  .replace('=', '')\r\n                  .replace('>', '');\r\n                innerhtml += `<select ${attributes} class=\"form-control ${extraclass}\" >`;\r\n                placeholder = '--|' + placeholder;\r\n                placeholder.split('|').forEach(function (choice) {\r\n                  innerhtml += '<option >' + choice + '</option>';\r\n                });\r\n                innerhtml += '</select>';\r\n              } else {\r\n                innerhtml += `<input type=\"text\" class=\"form-control ${extraclass}\" placeholder=\"${placeholder}\" ${attributes}>`;\r\n              }\r\n            }         \r\n\r\n            if (!arg.remark) {\r\n              innerhtml += `<small class=\"form-text text-muted\">Previous value: ${arg.checkbox ? (curvalue ? 'Checked' : 'Unchecked') : (curvalue || '')}</small>`;\r\n            }\r\n            innerhtml += `</div>`;\r\n          });\r\n        }\r\n        innerhtml += `<div style=\"margin-top: 16px;\">\r\n        <div class=\"toast hide\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" id=\"toast_${command.name}\">\r\n        <div class=\"toast-header\">\r\n        <strong class=\"mr-auto\">Result</strong\r\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"toast-body\" id=\"msg_${command.name}\"></div>\r\n      </div>`;\r\n        if (isConfig) {\r\n          innerhtml +=\r\n            `<button type=\"submit\" class=\"btn btn-info sclk\" id=\"btn-save-${command.name}\" cmdname=\"${command.name}\">Save</button>\r\n<button type=\"submit\" class=\"btn btn-warning cclk\" id=\"btn-commit-${command.name}\" cmdname=\"${command.name}\">Apply</button>`;\r\n        } else {\r\n          innerhtml += `<button type=\"submit\" class=\"btn btn-success sclk\" id=\"btn-run-${command.name}\" cmdname=\"${command.name}\">Execute</button>`;\r\n        }\r\n        innerhtml += '</div></fieldset></div></div>';\r\n        if (isConfig) {\r\n          $(targetDiv).append(innerhtml);\r\n        } else {\r\n          $('#commands-list').append(innerhtml);\r\n        }\r\n      }\r\n    });\r\n    $(\".sclk\").off('click').on('click', function () { runCommand(this, false); });\r\n    $(\".cclk\").off('click').on('click', function () { runCommand(this, true); });\r\n    data.commands.forEach(function (command) {\r\n      $('[cmdname=' + command.name + ']:input').val('');\r\n      $('[cmdname=' + command.name + ']:checkbox').prop('checked', false);\r\n      if (command.argtable) {\r\n        command.argtable.forEach(function (arg) {\r\n          const ctrlselector = '#' + command.name + '-' + arg.longopts;\r\n          const ctrlValue = getLongOps(data, command.name, arg.longopts);\r\n          if (arg.checkbox) {\r\n            $(ctrlselector)[0].checked = ctrlValue;\r\n          } else if (!arg.remark) {\r\n            if (ctrlValue !== undefined) {\r\n              $(ctrlselector)\r\n                .val(ctrlValue)\r\n                .trigger('change');\r\n            }\r\n            if (\r\n              $(ctrlselector)[0].value.length === 0 &&\r\n              (arg.datatype || '').includes('|')\r\n            ) {\r\n              $(ctrlselector)[0].value = '--';\r\n            }\r\n          }\r\n          if (arg.mincount && arg.mincount > 0) {\r\n            $(ctrlselector).removeClass('is-invalid');\r\n            $(ctrlselector).addClass('is-valid');\r\n          }\r\n        });\r\n      }\r\n    });\r\n    loadPresets();\r\n  }).fail(function (xhr, ajaxOptions, thrownError) {\r\n    if (xhr.status == 404) {\r\n      $('.orec').hide();\r\n    }\r\n    else {\r\n      handleExceptionResponse(xhr, ajaxOptions, thrownError);\r\n    }\r\n    $('#commands-list').empty();\r\n\r\n  });\r\n}\r\n\r\nfunction getConfig() {\r\n  $.ajaxSetup({\r\n    timeout: 7000 //Time in milliseconds\r\n  });\r\n  $.getJSON('/config.json', function (entries) {\r\n    $('#nvsTable tr').remove();\r\n    const data = (entries.config ? entries.config : entries);\r\n    SystemConfig = data;\r\n    commandBTSinkName = '';\r\n    Object.keys(data)\r\n      .sort()\r\n      .forEach(function (key) {\r\n        let val = data[key].value;\r\n        if (key === 'autoexec') {\r\nif (data.autoexec.value === '0') {\r\n            $('#disable-squeezelite')[0].checked = true;\r\n          } else {\r\n            $('#disable-squeezelite')[0].checked = false;\r\n          }\r\n        } else if (key === 'autoexec1') {\r\n          /* call new function to parse the squeezelite options */\r\n          processSqueezeliteCommandLine(val);\r\n        } else if (key === 'host_name') {\r\n          val = val.replaceAll('\"', '');\r\n          $('input#dhcp-name1').val(val);\r\n          $('input#dhcp-name2').val(val);\r\n          if ($('#cmd_opt_n').length == 0) {\r\n            $('#cmd_opt_n').val(val);\r\n          }\r\n          document.title = val;\r\n          hostName = val;\r\n        } else if (key === 'rel_api') {\r\n          releaseURL = val;\r\n        }\r\n        else if (key === 'enable_airplay') {\r\n          $(\"#s_airplay\").css({ display: isEnabled(val) ? 'inline' : 'none' })\r\n        }\r\n        else if (key === 'enable_cspot') {\r\n          $(\"#s_cspot\").css({ display: isEnabled(val) ? 'inline' : 'none' })\r\n        }\r\n        else if (key == 'preset_name') {\r\n          preset_name = val;\r\n        }\r\n        else if (key == 'board_model') {\r\n          board_model = val;\r\n        }\r\n\r\n        $('tbody#nvsTable').append(\r\n          '<tr>' +\r\n          '<td>' +\r\n          key +\r\n          '</td>' +\r\n          \"<td class='value'>\" +\r\n          \"<input type='text' class='form-control nvs' id='\" +\r\n          key +\r\n          \"'  nvs_type=\" +\r\n          data[key].type +\r\n          ' >' +\r\n          '</td>' +\r\n          '</tr>'\r\n        );\r\n        $('input#' + key).val(data[key].value);\r\n      });\r\n    if(commandBTSinkName.length > 0) {\r\n      // persist the sink name found in the autoexec1 command line\r\n      $('#cfg-audio-bt_source-sink_name').val(commandBTSinkName);\r\n    }\r\n    $('tbody#nvsTable').append(\r\n      \"<tr><td><input type='text' class='form-control' id='nvs-new-key' placeholder='new key'></td><td><input type='text' class='form-control' id='nvs-new-value' placeholder='new value' nvs_type=33 ></td></tr>\"\r\n    );\r\n    if (entries.gpio) {\r\n      $('#pins').show();\r\n      $('tbody#gpiotable tr').remove();\r\n      entries.gpio.forEach(function (gpioEntry) {\r\n        $('tbody#gpiotable').append(\r\n          '<tr class=' +\r\n          (gpioEntry.fixed ? 'table-secondary' : 'table-primary') +\r\n          '><th scope=\"row\">' +\r\n          gpioEntry.group +\r\n          '</th><td>' +\r\n          gpioEntry.name +\r\n          '</td><td>' +\r\n          gpioEntry.gpio +\r\n          '</td><td>' +\r\n          (gpioEntry.fixed ? 'Fixed' : 'Configuration') +\r\n          '</td></tr>'\r\n        );\r\n      });\r\n    }\r\n    else {\r\n      $('#pins').hide();\r\n    }\r\n  }).fail(function (xhr, ajaxOptions, thrownError) {\r\n    handleExceptionResponse(xhr, ajaxOptions, thrownError);\r\n  });\r\n}\r\n\r\nfunction processSqueezeliteCommandLine(val) {\r\n  const parsed = parseSqueezeliteCommandLine(val);\r\n  if (parsed.output.toUpperCase().startsWith('I2S')) {\r\n    handleTemplateTypeRadio('i2s');\r\n  } else if (parsed.output.toUpperCase().startsWith('SPDIF')) {\r\n    handleTemplateTypeRadio('spdif');\r\n  } else if (parsed.output.toUpperCase().startsWith('BT')) {\r\n    if(parsed.otherOptions.btname){ \r\n      commandBTSinkName= parsed.otherOptions.btname;\r\n    }\r\n    handleTemplateTypeRadio('bt');\r\n  }\r\n  Object.keys(parsed.options).forEach(function (key) {\r\n    const option = parsed.options[key];\r\n    if (!$(`#cmd_opt_${key}`).hasOwnProperty('checked')) {\r\n      $(`#cmd_opt_${key}`).val(option);\r\n    } else {\r\n      $(`#cmd_opt_${key}`)[0].checked = option;\r\n    }\r\n  });\r\n  if (parsed.options.hasOwnProperty('u')) {\r\n    // parse -u v[:i] and check the appropriate radio button with id #resample_v\r\n    const [resampleValue, resampleInterpolation] = parsed.options.u.split(':');\r\n    $(`#resample_${resampleValue}`).prop('checked', true);\r\n    // if resampleinterpolation is set, check  resample_i checkbox\r\n    if (resampleInterpolation) {\r\n      $('#resample_i').prop('checked', true);\r\n    }\r\n  }\r\n\r\n\r\n}\r\n\r\nfunction showLocalMessage(message, severity) {\r\n  const msg = {\r\n    message: message,\r\n    type: severity,\r\n  };\r\n  showMessage(msg, new Date());\r\n}\r\n\r\nfunction showMessage(msg, msgTime) {\r\n  let color = 'table-success';\r\n\r\n  if (msg.type === 'MESSAGING_WARNING') {\r\n    color = 'table-warning';\r\n    if (messageseverity === 'MESSAGING_INFO') {\r\n      messageseverity = 'MESSAGING_WARNING';\r\n    }\r\n  } else if (msg.type === 'MESSAGING_ERROR') {\r\n    if (\r\n      messageseverity === 'MESSAGING_INFO' ||\r\n      messageseverity === 'MESSAGING_WARNING'\r\n    ) {\r\n      messageseverity = 'MESSAGING_ERROR';\r\n    }\r\n    color = 'table-danger';\r\n  }\r\n  if (++messagecount > 0) {\r\n    $('#msgcnt').removeClass('badge-success');\r\n    $('#msgcnt').removeClass('badge-warning');\r\n    $('#msgcnt').removeClass('badge-danger');\r\n    $('#msgcnt').addClass(pillcolors[messageseverity]);\r\n    $('#msgcnt').text(messagecount);\r\n  }\r\n\r\n  $('#syslogTable').append(\r\n    \"<tr class='\" +\r\n    color +\r\n    \"'>\" +\r\n    '<td>' +\r\n    msgTime.toLocalShort() +\r\n    '</td>' +\r\n    '<td>' +\r\n    msg.message.encodeHTML() +\r\n    '</td>' +\r\n    '</tr>'\r\n  );\r\n}\r\n\r\nfunction inRange(x, min, max) {\r\n  return (x - min) * (x - max) <= 0;\r\n}\r\n\r\nfunction sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"bootstrap\");\nrequire(\"./sass/main.scss\");\nrequire(\"./assets/images/favicon-32x32.png\");\nrequire(\"./js/custom.js\");\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t826: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunksqueezelite_esp32\"] = self[\"webpackChunksqueezelite_esp32\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [987], () => (__webpack_require__(607)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","he","require","Promise","get_control_option_value","obj","ctrl","id","val","opt","$","concat","attr","checked","replace","includes","handleNVSVisible","nvs_previous_checked","isEnabled","Cookies","get","recovery","show","hide","undefined","match","window","bootstrap","String","prototype","format","Object","assign","args","arguments","this","number","encodeHTML","encode","Date","toLocalShort","toLocaleString","dateStyle","timeStyle","nvsTypes","btIcons","bt_playing","bt_disconnected","bt_neutral","bt_connecting","bt_connected","bt_disabled","play_arrow","pause","stop","batIcons","icon","label","ranges","f","t","btStateIcons","desc","sub","pillcolors","MESSAGING_INFO","MESSAGING_WARNING","MESSAGING_ERROR","connectReturnCode","OK","FAIL","DISC","LOST","RESTORE","ETH","taskStates","flashState","NONE","REBOOT_TO_RECOVERY","SET_FWURL","FLASHING","DONE","UPLOADING","ERROR","UPLOADCOMPLETE","_state","olderRecovery","statusText","flashURL","flashFileName","statusPercent","Completed","prevRecovery","updateModal","Modal","document","getElementById","reset","UpdateProgress","removeClass","prop","value","isStateError","html","parent","isStateUploadComplete","isStateNone","isStateRebootRecovery","isStateSetUrl","isStateFlashing","isStateDone","isStateUploading","init","SetStateError","addClass","SetStateNone","SetStateRebootRecovery","SetStatusText","ajax","url","context","dataType","method","cache","contentType","data","JSON","stringify","timestamp","now","error","xhr","_ajaxOptions","thrownError","_xhr$status","setOTAError","status","complete","response","SetStateSetUrl","post_config","fwurl","type","SetStateFlashing","SetStateDone","SetStateUploading","SetStateUploadComplete","isFlashExecuting","toString","_this","keys","find","x","setOTATargets","fileInput","files","length","message","SetStatusPercent","ShowDialog","pct","pctChanged","txt","changed","css","text","StartOTA","logEvent","name","TargetReadyStartOTA","UploadLocalFile","xhttp","XMLHttpRequest","boundHandleUploadProgressEvent","HandleUploadProgressEvent","bind","boundsetOTAError","upload","addEventListener","onreadystatechange","readyState","open","send","console","Math","round","loaded","total","EventTargetStatus","_data$ota_pct","_data$ota_dsc","ota_pct","ota_dsc","EventOTAMessageClass","otaData","parse","fun","log","hideSurrounding","presetsloaded","messageInterval","confPayload","config","handleExceptionResponse","parseSqueezeliteCommandLine","commandLine","output","options","otherValues","i","arg","startsWith","option","slice","join","trim","o","indexOf","substring","getOutput","n","getName","otherOptions","btname","toUpperCase","temp","isConnected","ConnectedTo","hasOwnProperty","ip","getIcon","icons","handleTemplateTypeRadio","outtype","children","display","commandDefaults","forEach","key","showLocalMessage","showCmdMessage","cmdname","msgtype","msgtext","append","color","escapedtext","hFlash","handleReboot","link","delayReboot","lmsBaseUrl","releaseURL","messagesHeld","commandBTSinkName","i2s","b","C","W","Z","spdif","bt","validOptions","codecs","messagecount","messageseverity","SystemConfig","LastCommandsState","hostName","versionName","prevmessage","project_name","board_model","platform_name","preset_name","btSinkNamesOptSel","ConnectingToSSID","prevLMSIP","ConnectingToActions","getConfigJson","slimMode","each","_index","entry","nvsType","parseInt","attributes","nvs_type","duration","empty","resolve","delay","then","rdata","HideCmdMessage","getCommands","getConfig","setPlatformFilter","filter","trigger","renderError","fieldname","errorFieldName","errorField","field","after","rssiToIcon","rssi","refreshAP","_ConnectedTo","urc","ajaxSetup","timeout","getJSON","_asyncToGenerator","_regeneratorRuntime","_callee","_context","prev","next","sleep","sort","a","y","refreshAPHTML2","formatAP","ssid","auth","rssi_icon","auth_icon","_ConnectedTo2","h","e","_ConnectedTo$rssi","wifiSelector","prepend","siblings","first","showTask","task","debug","nme","cpu","st","minstk","bprio","cprio","num","getBTSinkOpt","getMessages","_ref2","_callee2","_iterator","_step","_loop","msgTime","statsData","msgparts","attrs","j","curOpt","_context3","_createForOfIteratorHelper","msg","msgAge","_context2","current_time","sent_time","setTime","getTime","t0","abrupt","ntasks","tasks","showMessage","split","is","item","replaceWith","btEntry","remove","s","done","delegateYield","t1","finish","setTimeout","_x","apply","fail","ajaxOptions","handleWifiDialog","gw","netmask","Action","STS","ap_ssid","ap_pwd","setIcons","offline","textContent","handleNetworkStatus","hasConnectionChanged","checkStatus","_data$message","_data$recovery","handleRecoveryMode","tt","bt_status","bt_sub_status","iconindex","handlebtstate","depth","version","Voltage","bat_icon","voltage","_i3","_batIcons","_step2","iconEntry","_iterator2","entryRanges","err","batteryToIcon","is_i2c_locked","lms_ip","lms_port","baseUrl","success","Number","Jack","getLongOps","longopts","values","commands","command","cmdParts","isConfig","targetDiv","innerhtml","help","argtable","placeholder","datatype","ctrlname","curvalue","hasvalue","shortopts","checkbox","extraclass","mincount","glossary","remark","choice","off","on","runCommand","ctrlselector","ctrlValue","_","jqxhr","textStatus","entries","autoexec","parsed","_parsed$options$u$spl","u","_parsed$options$u$spl2","_slicedToArray","resampleValue","resampleInterpolation","processSqueezeliteCommandLine","replaceAll","title","gpio","gpioEntry","fixed","group","severity","ms","reason","_resolve","reject","saveAutoexec1","_get_control_option_v","optStr","resample","_i","_Object$entries","_Object$entries$_i","concatenateOptions","autoexec1","responseText","result","Result","handleDisconnect","handleConnect","pwd","dhcpname","ready","index","not","_get_control_option_v2","invalid","map","test","event","relatedTarget","CONN","MAN","FileReader","file","fr","onload","target","ex","alert","readAsText","slideUp","slideDown","preventDefault","set","createElement","href","URL","createObjectURL","Blob","setAttribute","body","appendChild","click","removeChild","branches","release","branch","push","fwb","assets","asset","browser_download_url","namecomponents","ver","cfg","bits","substr","lastIndexOf","created_at","idf","trclass","setURL","button","dataset","reboot","cmdstring","fields","allfields","querySelectorAll","selJson","cmd","model_config","_i2","_Object$entries2","_Object$entries2$_i","storedval","handleHWPreset","_step3","_iterator3","_attr$hasvalue","qts","isSelect","hasValue","validVal","_attr$longopts","_attr$shortopts","_attr$hasvalue2","_attr$longopts2","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","every","splice","r","getter","__esModule","d","definition","defineProperty","enumerable","g","globalThis","Function","Symbol","toStringTag","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}